function disableBubbleAndPreventDefault(a){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true}function setTouchEventOffsetPosition(c,b){c=c||event;if(c.touches&&c.touches.length){c=c.touches[0]}else{if(c.changedTouches&&c.changedTouches.length){c=c.changedTouches[0]}}var a,d;a=c.pageX-b.x;d=c.pageY-b.y;return{offsetX:a,offsetY:d}}function crossLinesAndTipMgr(b,a){if(typeof Tip!="function"){window.Tip=function(){};window.Tip.prototype={show:function(){},hide:function(){},update:function(){}}}this.canvas=b;this.options=a}crossLinesAndTipMgr.prototype._removeTipAndCrossLines=function(){var a=this;if(a.tip){a.tip.hide()}if(a.clsMgr){a.clsMgr.removeCrossLines()}};crossLinesAndTipMgr.prototype.updateOptions=function(a){this.options=a};crossLinesAndTipMgr.prototype._onMouseOrTouchMove=function(f){f=f||event;f=getOffset(f);var e=this;var k=e.options;var a=e.canvas;var g=getPageCoord(a);var c=k.triggerEventRanges;if(f.offsetX<c.x||f.offsetX>c.x+c.width||f.offsetY<c.y||f.offsetY>c.y+c.height){e._removeTipAndCrossLines();return}var b=k.getCrossPoint(f);var i={crossPoint:b,verticalRange:{y1:c.y,y2:c.y+c.height},horizontalRange:{x1:c.x,x2:c.x+c.width},color:k.crossLineOptions.color,canvas:a};if(!e.clsMgr){var j=new crossLines(i);j.setMouseEvents(function(n){n=n||event;n=getOffset(n);var m={offsetX:n.offsetX+c.x,offsetY:parseInt(e.clsMgr.getHLine().style.top)-g.y};var l=k.getCrossPoint(m);j.updateCrossPoint(l);if(e.tip){e.tip.update(l,k.tipOptions.getTipHtml(m))}},function(n){n=n||event;n=getOffset(n);var m={offsetX:parseInt(e.clsMgr.getVLine().style.left)-g.x,offsetY:n.offsetY+c.y};var l=k.getCrossPoint(m);j.updateCrossPoint(l);if(e.tip){e.tip.update(l,k.tipOptions.getTipHtml(m))}});e.clsMgr=j}else{e.clsMgr.updateOptions(i)}e.clsMgr.drawCrossLines();if(k.tipOptions){var d=k.tipOptions;if(!e.tip){var h=new Tip({position:{x:d.position.x||false,y:d.position.y||false},size:d.size,opacity:d.opacity||80,cssClass:d.cssClass,offsetToPoint:d.offsetToPoint||30,relativePoint:{x:b.x,y:b.y},canvas:a,canvasRange:k.triggerEventRanges,innerHTML:d.getTipHtml(f)});e.tip=h}e.tip.show(b,d.getTipHtml(f))}};crossLinesAndTipMgr.prototype._touchstart=function(a){a=a||event;disableBubbleAndPreventDefault(a);var b=a.srcElement||a.target||a.relatedTarget;this.touchstartTime=new Date()};crossLinesAndTipMgr.prototype._touchmove=function(d){d=d||event;disableBubbleAndPreventDefault(d);var b=this.canvas;var c=getPageCoord(b);var f=d.srcElement||d.target||d.relatedTarget;var a=setTouchEventOffsetPosition(d,c);this._onMouseOrTouchMove(a)};crossLinesAndTipMgr.prototype._touchend=function(f){f=f||event;disableBubbleAndPreventDefault(f);var g=f.srcElement||f.target||f.relatedTarget;var b=this.canvas;var a=setTouchEventOffsetPosition(f,getPageCoord(b));this._removeTipAndCrossLines();var d=new Date();var c=d.getTime()-this.touchstartTime.getTime();if(c<200){if(typeof this.options.onClick=="function"){this.options.onClick()}}};crossLinesAndTipMgr.prototype._mouseout=function(d){var f=d||event;d=getOffset(f);var c=this;var a=c.options.triggerEventRanges;if(d.offsetX<=a.x||d.offsetX>=a.x+a.width||d.offsetY<=a.y||d.offsetY>=a.y+a.height){c._removeTipAndCrossLines();return}var b=f.toElement||f.relatedTarget||f.target;if(b){if(b==c.canvas){return}if(b==c.clsMgr.getHLine()||b==c.clsMgr.getVLine()){return}c._removeTipAndCrossLines()}};crossLinesAndTipMgr.prototype.addCrossLinesAndTipEvents=function(){var d=this.canvas;var c=this.options;var a=getPageCoord(d);if(d.addCrossLinesAndTipEvents==true){return}d.addCrossLinesAndTipEvents=true;var b=isTouchDevice();var e=this;if(b){addEvent(d,"touchstart",function(f){e._touchstart.call(e,f)});addEvent(d,"touchmove",function(f){e._touchmove.call(e,f)});addEvent(d,"touchend",function(f){e._touchend.call(e,f)})}else{addEvent(d,"mouseout",function(f){e._mouseout.call(e,f)});addEvent(d,"mousemove",function(f){e._onMouseOrTouchMove.call(e,f)});if(typeof c.onClick=="function"){addEvent(d,"click",c.onClick)}}};function addCrossLinesAndTipEvents(b,a){if(!b.crossLineAndTipMgrInstance){b.crossLineAndTipMgrInstance=new crossLinesAndTipMgr(b,a);b.crossLineAndTipMgrInstance.addCrossLinesAndTipEvents()}};