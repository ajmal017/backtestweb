"use strict";var common={initCheckLogin:function(a){if(a.status==-100){window.location.href="login.php"}},login:function(a,b,c){$.ajax({url:"ajax/login/user_login.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){c&&c(d)}})},getPlatformList:function(a,b){$.ajax({url:"ajax/login/get_platform_info.php",type:"post",dataType:"json",cache:false,beforeSend:function(){a&&a()},success:function(c){b&&b(c)}})},getTopTwentyStock:function(a,b,c){$.ajax({url:"ajax/ajax_get_hot_data.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getRelatedInfo:function(a,b,c){$.ajax({url:"ajax/ajax_get_related_info.php",dataType:"json",type:"post",data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getEventRelatedInfo:function(a,b,c){$.ajax({url:"ajax/ajax_get_event_relatedinfo.php",dataType:"json",type:"post",data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getNews:function(b,a){a=a||false;b.info_type_list="1,0,0,0,0,0";common.getRelatedInfo(b,function(){$("#wk-news").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-news .mCSB_container").html(common.buildNews(c.news,a))}else{$("#wk-news .mCSB_container").append(common.buildNews(c.news,a))}})},getSelfMedia:function(b,a){a=a||false;b.info_type_list="0,0,1,0,0,0";common.getRelatedInfo(b,function(){$("#wk-selfmedia").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-selfmedia .mCSB_container").html(common.buildMedia(c.me_media,a))}else{$("#wk-selfmedia .mCSB_container").append(common.buildMedia(c.me_media,a))}})},getFastNews:function(b,a){a=a||false;b.info_type_list="0,1,0,0,0,0";common.getRelatedInfo(b,function(){$("#wk-newsflash").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-newsflash .mCSB_container").html(common.buildFastNews(c.fast_info,a))}else{$("#wk-newsflash .mCSB_container").append(common.buildFastNews(c.fast_info,a))}})},getNotice:function(b,a){a=a||false;b.info_type_list="0,0,0,0,0,0,1";common.getRelatedInfo(b,function(){$("#wk-notice").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-notice .mCSB_container").html(common.buildNotice(c.notice,a))}else{$("#wk-notice .mCSB_container").append(common.buildNotice(c.notice,a))}})},getReports:function(b,a){a=a||false;b.info_type_list="0,0,0,0,0,0,0,1";common.getRelatedInfo(b,function(){$("#wk-report").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-report .mCSB_container").html(common.buildReport(c.report,a))}else{$("#wk-report .mCSB_container").append(common.buildReport(c.report,a))}})},getEventNews:function(b,a){a=a||false;common.getEventRelatedInfo(b,function(){$("#wk-news").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-news .mCSB_container").html(common.buildNews(c.result,a))}else{$("#wk-news .mCSB_container").append(common.buildNews(c.result,a))}})},getEventMedia:function(b,a){a=a||false;common.getEventRelatedInfo(b,function(){$("#wk-selfmedia").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-selfmedia .mCSB_container").html(common.buildMedia(c.result,a))}else{$("#wk-selfmedia .mCSB_container").append(common.buildMedia(c.result,a))}})},getEventFastNews:function(b,a){a=a||false;common.getEventRelatedInfo(b,function(){$("#wk-newsflash").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-newsflash .mCSB_container").html(common.buildFastNews(c.result,a))}else{$("#wk-newsflash .mCSB_container").append(common.buildFastNews(c.result,a))}})},getEventNotice:function(b,a){a=a||false;common.getEventRelatedInfo(b,function(){$("#wk-notice").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-notice .mCSB_container").html(common.buildNotice(c.result,a))}else{$("#wk-notice .mCSB_container").append(common.buildNotice(c.result,a))}})},getEventReport:function(b,a){a=a||false;common.getEventRelatedInfo(b,function(){$("#wk-report").append(common.getLoading())},function(c){common.hideLoading();if(b.start_id==0){$("#wk-report .mCSB_container").html(common.buildReport(c.result,a))}else{$("#wk-report .mCSB_container").append(common.buildReport(c.result,a))}})},buildNews:function(b,a){a=a||false;var d=[];if(b.length>0){for(var c=0;c<b.length;c++){d.push('<div class="wk-news-list" id="news_'+b[c].info_id+'" data-news-timestamp="'+b[c].timestamp+'">');d.push('<div class="wk-news-list-head">');d.push('<p class="wk-news-list-title"><a href="detail.php?infoid='+b[c].info_id+'" target="_blank">');d.push(b[c].title);d.push("</a></p>"+Utility.getgetEmotion(b[c].sentiment)+'</div><div class="wk-news-list-con"><p>');if(b[c].summary!=""){d.push("<strong>【机器人摘要】</strong>");d.push(b[c].summary);d.push('<a href="detail.php?infoid='+b[c].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}d.push("</p><span>来源："+b[c].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(b[c].timestamp)+"</span></div><hr></div>")}}else{if(a){d.push('<div class="wk-news-no"><img src="static/imgs/i/nonews.png"><span>暂无相关新闻资讯</span></div>')}}return d.join("")},buildFastNews:function(d,a){a=a||false;var f=[];if(d.length>0){common.hideLoading();for(var e in d){for(var c in d[e]){f.push('<div class="wk-user-fastnews">');f.push('<span class="wk-user-fastnews-dot">●</span>');f.push('<p class="wk-user-fastnews-todate">'+c+"</p>");f.push("<ul>");for(var b=0;b<d[e][c].length;b++){f.push("<li id='"+d[e][c][b].info_id+"' data-fastnews-timestamp='"+d[e][c][b].timestamp+"'>");f.push("<label>"+Utility.unixToTime(d[e][c][b].timestamp)+"</label>");f.push("<p>"+d[e][c][b].summary+"</p>");f.push("</li>")}f.push("</ul></div>")}}}else{if(a){f.push('<div class="wk-news-no"><img src="static/imgs/i/nonews.png"><span>暂无相关快讯</span></div>')}}return f.join("")},buildMedia:function(c,b){b=b||false;var a=[];if(c.length>0){common.hideLoading();for(var d=0;d<c.length;d++){a.push('<div class="wk-news-list" id="media_'+c[d].info_id+'" data-media-timestamp="'+c[d].timestamp+'"><div class="wk-news-list-head">');a.push('<p class="wk-news-list-title">');a.push('<a href="detail.php?infoid='+c[d].info_id+'" target="_blank">'+c[d].title+"</a></p>");a.push(Utility.getgetEmotion(c[d].sentiment));a.push('</div><div class="wk-news-list-con"><p>');if(c[d].summary!=""){a.push("<strong>【机器人摘要】</strong>");a.push(c[d].summary);a.push('<a href="detail.php?infoid='+c[d].info_id+'" target="_blank"> <i class="fa fa-link"></i>详情链接</a>')}a.push("</p><span>来源："+c[d].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(c[d].timestamp)+"</span></div><hr></div>")}}else{if(b){a.push('<div class="wk-news-no"><img src="static/imgs/i/nonews.png"><span>暂无相关达人观点</span></div>')}}return a.join("")},buildNotice:function(b,a){a=a||false;var d=[];if(b.length>0){common.hideLoading();for(var c=0;c<b.length;c++){d.push('<div class="wk-news-list" id="notice_'+b[c].info_id+'" data-news-timestamp="'+b[c].timestamp+'">');d.push('<div class="wk-news-list-head">');d.push('<p class="wk-news-list-title"><a href="detail.php?infoid='+b[c].info_id+'" target="_blank">');d.push(b[c].title);d.push("</a></p>"+Utility.getgetEmotion(b[c].sentiment)+'</div><div class="wk-news-list-con"><p>');if(b[c].summary!==""){d.push("<strong>【机器人摘要】</strong>");d.push(b[c].summary);d.push('<a href="detail.php?infoid='+b[c].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}d.push("</p><span>来源："+b[c].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(b[c].timestamp)+"</span></div><hr></div>")}}else{if(a){d.push('<div class="wk-news-no"><img src="static/imgs/i/nonews.png"><span>暂无相关公告</span></div>')}}return d.join("")},buildReport:function(c,b){b=b||false;var a=[];if(c.length>0){common.hideLoading();for(var d=0;d<c.length;d++){a.push('<div class="wk-news-list" id="report_'+c[d].info_id+'" data-news-timestamp="'+c[d].timestamp+'">');a.push('<div class="wk-news-list-head">');a.push('<p class="wk-news-list-title"><a href="detail.php?infoid='+c[d].info_id+'" target="_blank">');a.push(c[d].title);a.push("</a></p>"+Utility.getgetEmotion(c[d].sentiment)+'</div><div class="wk-news-list-con"><p>');if(c[d].summary!==""){a.push("<strong>【机器人摘要】</strong>");a.push(c[d].summary);a.push('<a href="detail.php?infoid='+c[d].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}a.push("</p><span>来源："+c[d].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(c[d].timestamp)+"</span></div><hr></div>")}}else{if(b){a.push('<div class="wk-news-no"><img src="static/imgs/i/nonews.png"><span>暂无相关研报</span></div>')}}return a.join("")},getLineChart:function(f,a,d,e,c){var b=echarts.init(document.getElementById(f));b.showLoading({text:"加载中..."});b.setOption({color:["rgb(243, 104, 97)","rgb(76, 93, 186)","rgb(118, 172, 245)"],tooltip:{trigger:"axis",formatter:function(i){var g="";g+=i[0].name+"<br>";for(var h in i){if(i[h].value&&i[h].value!=0){if(i[0].name==i[h].name){g+="<label style='color: "+i[h].color+";font-size: 14x;'>●</label>&nbsp;&nbsp;"+i[h].seriesName+":"+Utility.formatNum(i[h].value)+"<br>"}}}return g}},grid:{top:"12%",left:"6%",right:"5%",bottom:0,containLabel:true},legend:{left:"left",data:["查看","搜索","关注"],padding:[0,0,0,15],selected:{"搜索":false,"关注":false}},xAxis:{type:"category",boundaryGap:false,data:a},yAxis:{type:"value",position:"right",scale:true,min:"dataMin",max:"dataMax"},calculable:false,series:[{name:"查看",type:"line",smooth:true,data:d},{name:"搜索",type:"line",smooth:true,data:e},{name:"关注",type:"line",smooth:true,data:c}]});b.hideLoading();window.onresize=b.resize},getTreemap:function(wk_treemap_data){for(var x in wk_treemap_data){if(Utility.timeRange("09:15","09:25")){$("#"+wk_treemap_data[x].key).html('<div class="wk-hotmap-no"><img src="static/imgs/i/nonews.png"><span>自由竞价时间,暂无数据</span></div>')}else{var myChart=echarts.init(document.getElementById(""+wk_treemap_data[x].key+""));var cdata=[];for(var y in wk_treemap_data[x].value){if(wk_treemap_data[x].key.indexOf("wk-stock")==0){var tname=wk_treemap_data[x].value[y].name;var tcode=wk_treemap_data[x].value[y].code;var tvalue=(parseFloat(wk_treemap_data[x].value[y].value)*100).toFixed(2);var tpricelevel=wk_treemap_data[x].value[y].price_level;var tstop=wk_treemap_data[x].value[y].stop;if(tstop==1){cdata.push('{name:"'+tname+"\\n("+tcode+")\\n"+(tvalue>0?"+":"")+tvalue+'%"')}else{cdata.push('{name:"'+tname+"\\n("+tcode+")\\n"+(tvalue>0?"+":"")+tvalue+'%"')}cdata.push("value:"+wk_treemap_data[x].value[y].count);cdata.push("itemStyle:{normal:{color:'"+Utility.getTreeMapColor(tpricelevel)+"'}}");if(tpricelevel==-1){cdata.push("label:{normal:{textStyle:{color:'#23a64c'}}}}")}else{if(tpricelevel==1){cdata.push("label:{normal:{textStyle:{color:'#f54545'}}}}")}else{cdata.push("label:{normal:{textStyle:{color:'#fff'}}}}")}}}else{var tsvalue=(parseFloat(wk_treemap_data[x].value[y].value)*100).toFixed(2);cdata.push('{name:"'+wk_treemap_data[x].value[y].name+"\\n"+(tsvalue>0?"+":"")+tsvalue+'%"');cdata.push("value:"+wk_treemap_data[x].value[y].count);cdata.push("itemStyle:{normal:{color:'"+Utility.getTreeMapColor(wk_treemap_data[x].value[y].price_level)+"'}}");if(wk_treemap_data[x].value[y].price_level==-1){cdata.push("label:{normal:{textStyle:{color:'#23a64c'}}}}")}else{if(wk_treemap_data[x].value[y].price_level==1){cdata.push("label:{normal:{textStyle:{color:'#f54545'}}}}")}else{cdata.push("label:{normal:{textStyle:{color:'#fff'}}}}")}}}}myChart.setOption({tooltip:{formatter:"{b}"},series:[{type:"treemap",breadcrumb:{show:false},roam:false,nodeClick:"link",width:"100%",height:"100%",itemStyle:{normal:{borderWidth:1}},data:eval("["+cdata.join(",")+"]")}]});window.onresize=myChart.resize}}},getHotRecord:function(a,b,c){$.ajax({url:"ajax/ajax_get_hotrecord.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getRealTimeHot:function(a,b,c){$.ajax({url:"ajax/ajax_get_real_time_hot.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getNewsTrend:function(a,b,c){$.ajax({url:"ajax/ajax_get_news_trend.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getSingleRealTimeHot:function(a,b,c){$.ajax({url:"ajax/ajax_get_single_real_time_hot.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getHyAndGnHot:function(a,b,c){$.ajax({url:"ajax/ajax_get_hy_and_gn_hot.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getStockBase:function(a,b,c){$.ajax({url:"ajax/ajax_get_stock_base.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getRelateSHG:function(a,b,c){$.ajax({url:"ajax/ajax_get_relate_shg.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getRateLine:function(a,b,c){$.ajax({url:"ajax/ajax_get_rateline.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},buildRateLine:function(k,m,l){var a=[];var g=[];var d=[];if(l.body&&l.body.list.length>0){var h=l.body.list;if(m==="today"){for(var e=0;e<h.length;e++){a.push(Utility.unixToTime(h[e].trade_time*1000));g.push(h[e].day_yield);d.push(h[e].hs300_day_yield)}}else{for(var c=0;c<h.length;c++){a.push(h[c].date);g.push(h[c].adjusted_day_yield);d.push(h[c].hs300_adjusted_day_yield)}a.reverse();g.reverse();d.reverse()}}var b=echarts.init(document.getElementById("wk-rate-line-pic"));var f={tooltip:{trigger:"axis",formatter:function(n){var i="";i+=n[0].name+"<br>";for(var j in n){if(n[j].value&&n[j].value!=0){if(n[0].name==n[j].name){i+="<label style='color: "+n[j].color+";font-size: 14px;'>●</label>&nbsp;&nbsp;"+n[j].seriesName+":"+(n[j].value*100).toFixed(2)+"%<br>"}}}return i}},color:["rgb(151,47,134)","rgb(65,77,92)"],legend:{data:[k,"沪深300"],top:0},grid:{top:"25px",left:"0",right:"0",bottom:0,containLabel:true},xAxis:{type:"category",boundaryGap:false,data:a,axisLabel:{rotate:45}},yAxis:{type:"value",position:"right",axisLabel:{formatter:function(i){if(i!=0){return(i*100).toFixed(2)+"%"}else{return 0}}}},series:[{name:k,type:"line",smooth:true,data:JSON.parse("["+g+"]")},{name:"沪深300",type:"line",smooth:true,data:JSON.parse("["+d+"]")}]};b.setOption(f);window.onresize=b.resize},buildStockTable:function(a){var c=[];a.sort(function(g,f){return Math.abs(f.value)-Math.abs(g.value)});if(a.length>0){for(var d=0;d<a.length;d++){var b=a[d].value;c.push("<tr>");c.push("<td>"+(d+1)+"</td>");c.push("<td><a href='stocks.php?stock="+a[d].code+"' target='_blank'>"+a[d].name+"</a></td>");c.push("<td class='"+common.getUpDownColor(a[d].mark_z_d)+"'>"+a[d].price+"</td>");c.push("<td class='"+common.getUpDownColor(a[d].price_change_ratio)+"'>"+(a[d].price_change_ratio*100).toFixed(2)+"%</td>");c.push("<td>"+a[d].hot+"</td>");c.push("<td class='"+common.getUpDownColor(b)+"'>"+(b>0?"+":"")+b+"</td>");c.push("<td>"+(a[d].count/10000/100).toFixed(2)+"</td>");c.push("</tr>")}return c.join("")}else{var e='<tr><td colspan="7" style="height:260px;line-height:260px;color:#545454;font-size:18px;"><img src="/static/imgs/i/index_nodata.png">&nbsp;&nbsp;&nbsp;暂时没有数据</td></tr>';return e}},buildOtherTable:function(b,a){if(b.length>0){var d=[];b.sort(function(h,g){return g.value-h.value});for(var e=0;e<b.length;e++){var c=b[e].value;d.push("<tr>");d.push("<td>"+(e+1)+"</td>");d.push("<td><a href='"+a+".php?name="+b[e].name+"' target='_blank'>"+b[e].name+"</a></td>");d.push("<td>"+b[e].hot.toFormatNum()+"</td>");d.push("<td class='"+common.getUpDownColor(c)+"'>"+(c>0?"+":"")+c.toFormatNum()+"</td>");d.push("<td>"+(b[e].count/10000/100).toFixed(2)+"</td>");d.push("</tr>")}return d.join("")}else{$(this).find(".wk-treemap-table").css({height:"294px","text-align":"center","line-height":"294px",color:"#545454","font-size":"18px"});var f='<tr><td colspan="5" style="height:260px;line-height:260px;color:#545454;font-size:18px;"><img src="/static/imgs/i/index_nodata.png">&nbsp;&nbsp;&nbsp;暂时没有数据</td></tr>';return f}},buildHotmapTable:function(b,a){var d=[];if(b.length>0){if(a=="stock"){for(var c=0;c<b.length;c++){d.push("<tr><td>"+(c+1)+"</td>");d.push('<td><a href="stocks.php?stock='+b[c].code+'" target="_blank">'+b[c].name+"</a></td>");d.push("<td>"+b[c].value+"</td>");d.push("<td>"+b[c].increment+Utility.getHotUpDown(b[c].increment)+"</td>");d.push('<td class="'+Utility.getPriceColor(b[c].mark_z_d)+'">'+b[c].price+"</td></tr>")}}else{for(var c=0;c<b.length;c++){d.push("<tr><td>"+(c+1)+"</td>");d.push('<td><a href="'+a+".php?name="+b[c].name+'" target="_blank">'+b[c].name+"</a></td>");d.push("<td>"+b[c].value+"</td>");d.push("<td>"+b[c].increment+Utility.getHotUpDown(b[c].increment)+"</td></tr>")}}}return d.join("")},buildHotmap:function(buildId,buildData,buildType){var myChart=echarts.init(document.getElementById(buildId));myChart.hideLoading();var cdata=[];for(var y in buildData){if(buildType=="stock"){var tname=buildData[y].name;var tcode=buildData[y].code;var tvalue=buildData[y].value;var tpricelevel=buildData[y].price_level;var tstop=buildData[y].stop;if(tstop==1){cdata.push('{name:"'+tname+"\\n("+tcode+")\\n"+(tvalue>0?"+":"")+tvalue+'"')}else{cdata.push('{name:"'+tname+"\\n("+tcode+")\\n"+(tvalue>0?"+":"")+tvalue+'"')}cdata.push("value:"+buildData[y].count);cdata.push("itemStyle:{normal:{color:'"+Utility.getTreeMapColor(tpricelevel)+"'}}");if(tpricelevel==-1){cdata.push("label:{normal:{textStyle:{color:'#23a64c'}}}}")}else{if(tpricelevel==1){cdata.push("label:{normal:{textStyle:{color:'#f54545'}}}}")}else{cdata.push("label:{normal:{textStyle:{color:'#fff'}}}}")}}}else{var tsvalue=buildData[y].value;cdata.push('{name:"'+buildData[y].name+"\\n"+(tsvalue>0?"+":"")+tsvalue+'"');cdata.push("value:"+buildData[y].count);cdata.push("itemStyle:{normal:{color:'"+Utility.getTreeMapColor(buildData[y].price_level)+"'}}");if(buildData[y].price_level==-1){cdata.push("label:{normal:{textStyle:{color:'#23a64c'}}}}")}else{if(buildData[y].price_level==1){cdata.push("label:{normal:{textStyle:{color:'#f54545'}}}}")}else{cdata.push("label:{normal:{textStyle:{color:'#fff'}}}}")}}}}myChart.setOption({tooltip:{formatter:"{b}"},series:[{type:"treemap",breadcrumb:{show:false},roam:false,nodeClick:"link",width:"100%",height:"100%",itemStyle:{normal:{borderWidth:1}},data:eval("["+cdata.join(",")+"]")}]});window.onresize=myChart.resize},initRelateSHG:function(b,a,d){var c=echarts.init(document.getElementById("wk-relate-chart"));common.getRelateSHG({query_type:b,key_name:a},function(){c.showLoading({text:"加载中..."})},function(e){if(e.status==1){c.hideLoading();d&&d(e)}})},getUpDownColor:function(a){return a>0?"wk-red":a<0?"wk-green":"wk-gray"},getLoading:function(){var a=[];a.push('<div id="loading">');a.push('		<div id="loading-center">');a.push('			<div id="loading-center-absolute">');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push('				<div class="object"></div>');a.push("			</div>");a.push("		</div>");a.push("	</div>");return a.join("")},hideLoading:function(){$("#loading").remove()},getHotRank:function(a,b,c){$.ajax({url:"ajax/hotrank/ajax_get_hot_rank.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){c&&c(d)}})},buildTwoLineChart:function(h,d,a,g,b,e){var c=echarts.init(document.getElementById(h));var f={color:[d],tooltip:{trigger:"axis"},legend:{data:[{name:a,icon:"circle"}],bottom:"0"},grid:{top:"10px",left:"auto",right:"auto",bottom:"10%",containLabel:true},xAxis:{type:"category",boundaryGap:true,data:g,splitLine:{show:false},axisLine:{show:false},axisLabel:{show:false}},yAxis:[{type:"value",position:e}],series:[{name:a,type:"bar",barWidth:8,smooth:true,data:b}]};c.showLoading({text:"加载中..."});c.setOption(f);c.hideLoading();window.onresize=c.resize},buildReleatedInfoChart:function(m,h){if(h.stock.length==0&&h.industry.length==0&&h.notion.length==0&&h.event.length==0){$("#wk-relate-chart").html("<div style='font-size: 18px;text-align: center;padding-top: 240px;'><img src=\"/static/imgs/i/index_nodata.png\">&nbsp;&nbsp;&nbsp;&nbsp;暂无关联信息</div>");return}m=decodeURI(m);var B=[{name:m,symbolSize:60,category:0,draggable:true}];var c=[];var x=[{name:m,itemStyle:{normal:{color:"rgba(85,111,181,1)"}}},{name:"关联股票",itemStyle:{normal:{color:"rgba(158,90,147,1)"}}},{name:"关联行业",itemStyle:{normal:{color:"rgba(55,119,157,1)"}}},{name:"关联概念",itemStyle:{normal:{color:"rgba(92,95,135,1)"}}},{name:"关联事件",itemStyle:{normal:{color:"rgba(97,150,156,1)"}}}];var o=30;var n=10;var f=[],r=[],a=[],z=[],g=[],e=[],C=[],d=[];if(h.stock.length>0){f.push('{"name": "关联股票","symbolSize": 30,"category": 1,"draggable": true}');r.push('{"source": "关联股票","target": "'+m+'","lineStyle": {"normal": {}}}');for(var y=0,p=h.stock.length;y<p;y++){f.push('{"name": "'+h.stock[y].stock_name+"("+h.stock[y].stock_code+')","symbolSize": '+Utility.getRandom(o,n)+',"category": 1,"draggable": true,"itemStyle": {"normal": {"color": "rgba(158,90,147,1)"}}}');r.push('{"source": "关联股票","target": "'+h.stock[y].stock_name+"("+h.stock[y].stock_code+')","lineStyle": {"normal": {"color": "rgba(158,90,147,1)"}}}')}B=B.concat(JSON.parse("["+f+"]"));c=c.concat(JSON.parse("["+r+"]"))}if(h.industry.length>0){a.push('{"name": "关联行业","symbolSize": 30,"category": 2,"draggable": true}');z.push('{"source": "关联行业","target": "'+m+'","lineStyle": {"normal": {}}}');for(var w=0,s=h.industry.length;w<s;w++){a.push('{"name": "'+h.industry[w].industry+'","symbolSize": '+Utility.getRandom(o,n)+',"category": 2,"draggable": true,"itemStyle": {"normal": {"color": "rgba(55,119,157,1)"}}}');z.push('{"source": "关联行业","target": "'+h.industry[w].industry+'","lineStyle": {"normal": {"color": "rgba(55,119,157,1)"}}}')}B=B.concat(JSON.parse("["+a+"]"));c=c.concat(JSON.parse("["+z+"]"))}if(h.notion.length>0){g.push('{"name": "关联概念","symbolSize": 30,"category": 3,"draggable": true}');e.push('{"source": "关联概念","target": "'+m+'","lineStyle": {"normal": {}}}');for(var v=0,u=h.notion.length;v<u;v++){g.push('{"name": "'+h.notion[v].section+'","symbolSize": '+Utility.getRandom(o,n)+',"category": 3,"draggable": true,"itemStyle": {"normal": {"color": "rgba(92,95,135,1)"}}}');e.push('{"source": "关联概念","target": "'+h.notion[v].section+'","lineStyle": {"normal": {"color": "rgba(92,95,135,1)"}}}')}B=B.concat(JSON.parse("["+g+"]"));c=c.concat(JSON.parse("["+e+"]"))}if(h.event.length>0){C.push('{"name": "关联事件","symbolSize": 30,"category": 4,"draggable": true}');d.push('{"source": "关联事件","target": "'+m+'","lineStyle": {"normal": {}}}');for(var t=0,A=h.event.length;t<A;t++){C.push('{"name": "'+h.event[t].event_name+'","symbolSize": '+Utility.getRandom(o,n)+',"category": 4,"draggable": true,"itemStyle": {"normal": {"color": "rgba(98,166,174,1)"}}}');d.push('{"source": "关联事件","target": "'+h.event[t].event_name+'","lineStyle": {"normal": {"color": "rgba(98,166,174,1)"}}}')}B=B.concat(JSON.parse("["+C+"]"));c=c.concat(JSON.parse("["+d+"]"))}var b=echarts.init(document.getElementById("wk-relate-chart"));var q={color:["rgb(85,111,181)","rgb(158,90,147)","rgb(55,119,157)","rgb(92,95,135)","rgb(98,166,174)"],animation:false,legend:[{data:x}],series:[{name:"关联信息",type:"graph",layout:"force",draggable:false,data:B,links:c,categories:x,roam:true,label:{normal:{show:true,position:"bottom"}},force:{repulsion:400}}]};b.setOption(q);b.on("click",function(j){var i=j.data.name;switch(j.data.category){case 1:if(i!="关联股票"){window.open("stocks.php?stock="+i.substring(i.indexOf("(")+1,i.indexOf(")")))}break;case 2:if(i!="关联行业"){window.open("industry.php?name="+i)}break;case 3:if(i!="关联概念"){window.open("concept.php?name="+i)}break;case 4:if(i!="关联事件"){window.open("event.php?name="+i)}break}});window.onresize=b.resize},initdoubleLine:function(c,b){var g=[],d=[],a=[];var f=echarts.init(document.getElementById("double-chart-a"));var e=echarts.init(document.getElementById("double-chart-b"));common.getNewsTrend({query_type:c,key_name:b},function(){f.showLoading({text:"加载中..."});e.showLoading({text:"加载中..."})},function(h){f.hideLoading();e.hideLoading();if(h.status==1){for(var k=0,j=h.infotrend.length;k<j;k++){g.push(h.infotrend[k]["date"]);d.push(h.infotrend[k]["info_count"]);a.push(h.infotrend[k]["info_senti"])}if(h.senti_per){var l=h.senti_per.neg_per;var m=h.senti_per.pos_per;$(".pro_chart .progress_neg_per").css("width",l*100+"%");if(m>0){$(".progress_neg").css("background-color","#e96c6c")}$(".sacle .negative_per").html((l*100).toFixed(0));$(".sacle .positive_per").html((m*100).toFixed(0))}common.buildTwoLineChart("double-chart-a","rgb(92,164,234)","新闻数量",g,d,"left");common.buildTwoLineChart("double-chart-b","rgb(255,168,95)","情感指数",g,a,"right")}})}};var inforcenter={addGroup:function(a,b,c){a.operate_code=1;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},delGroup:function(a,b,c){a.operate_code=2;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},modifyGroup:function(a,b,c){a.operate_code=3;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},showGroup:function(a,b){$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:{operate_code:4},beforeSend:function(){a&&a()},success:function(c){common.initCheckLogin(c);b&&b(c)}})},addStock:function(a,b,c){a.operate_code=5;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},delStock:function(a,b,c){a.operate_code=6;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},showstock:function(a,b,c){a.operate_code=7;$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getStockPoint:function(a,b){$.ajax({url:"../ajax/infocenter/ajax_get_stock_group.php",type:"post",dataType:"json",cache:false,data:{operate_code:8},beforeSend:function(){a&&a()},success:function(c){common.initCheckLogin(c);b&&b(c)}})},getRelatedInfo:function(a,b,c){$.ajax({url:"../ajax/infocenter/ajax_get_relatedinfo.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},getPlatform:function(a,b){$.ajax({url:"../ajax/infocenter/ajax_get_all_platform.php",type:"post",dataType:"json",cache:false,beforeSend:function(){a&&a()},success:function(c){common.initCheckLogin(c);b&&b(c)}})},addUserPlatform:function(a,b,c){a.custom_type=2;$.ajax({url:"../ajax/infocenter/ajax_ctrl_customplat.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})},delUserPlatform:function(a,b,c){a.custom_type=3;$.ajax({url:"../ajax/infocenter/ajax_ctrl_customplat.php",type:"post",dataType:"json",cache:false,data:a,beforeSend:function(){b&&b()},success:function(d){common.initCheckLogin(d);c&&c(d)}})}};