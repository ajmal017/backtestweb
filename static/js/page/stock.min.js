"use strict";(function(d,j,o){var e=Utility.getQueryStringByName("stock");var l="";var a=["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24：00"];var p=[],c=[],t=[];var n,x;var i=e+"s";function u(B,A,D,C){return"<a href='hotrank.php?key="+B+","+A+","+D+","+C+"' class='wk-view-more' target='_blank'>更多&nbsp;<i class='fa fa-angle-double-right'></i></a>"}function q(){var A=echarts.init(o.getElementById("left-hot-chart"));common.getSingleRealTimeHot({stock:e,hour_data:"stock"},function(){A.showLoading({text:"加载中..."})},function(C){if(C.status===1){var B=[];var O=[];if(C.visit){var G=0;for(var M in C.visit){if(C.visit.hasOwnProperty(M)){p.push(C.visit[M]);G++}}p=JSON.parse("["+p.join(",")+"]");var J=Math.max.apply(Math,p);var H=p.indexOf(Math.max.apply(Math,p));O.push("<tr><td>查看</td><td>"+p[p.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(G-1)+":00")+"</td></tr>");B.push("<tr><td>查看</td><td>"+J+"</td><td>"+Utility.calTime(H)+"</td></tr>")}if(C.search){var D=0;for(var P in C.search){if(C.search.hasOwnProperty(P)){c.push(C.search[P]);D++}}c=JSON.parse("["+c.join(",")+"]");var N=Math.max.apply(Math,c);var I=c.indexOf(Math.max.apply(Math,c));O.push("<tr><td>搜索</td><td>"+c[c.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(D-1)+":00")+"</td></tr>");B.push("<tr><td>搜索</td><td>"+N+"</td><td>"+Utility.calTime(I)+"</td></tr>")}if(C.follow){var L=0;for(var F in C.follow){if(C.follow.hasOwnProperty(F)){t.push(C.follow[F]);L++}}t=JSON.parse("["+t.join(",")+"]");var E=Math.max.apply(Math,t);var K=t.indexOf(Math.max.apply(Math,t));O.push("<tr><td>关注</td><td>"+t[t.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(L-1)+":00")+"</td></tr>");B.push("<tr><td>关注</td><td>"+E+"</td><td>"+Utility.calTime(K)+"</td></tr>")}d(".todayhot").html(B.join(""));d(".latesthot").html(O.join(""));common.getLineChart("left-hot-chart",a,p,c,t)}})}function v(C){var F=["wk-industry-view-treemap","wk-concept-view-treemap"];for(var G in F){if(F.hasOwnProperty(G)){var J=echarts.init(o.getElementById(F[G]));J.showLoading({text:"加载中..."})}}if(C.status===1){var I=C.stock_info.industry;var B=C.stock_info.section;var K="";var A="";if(I.length>0){d(".hy-title").html(I[0].indus+"行业热度情况");for(var G in I){if(I.hasOwnProperty(G)){K+="<a href='industry.php?name="+I[G].indus+"' target='_blank'>"+I[G].indus+"</a>"}}}if(B.length>0){d(".gn-title").html(B[0].sect+"概念热度情况");for(var E in B){if(B.hasOwnProperty(E)){A+="<a href='concept.php?name="+B[E].sect+"' target='_blank'>"+B[E].sect+"</a>"}}}if(d("#industry-view").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#industry-view").find(".col-md-5 .wk-hot-sub-title").append(u(1,2,2,I[0].indus))}if(d("#industry-search").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#industry-search").find(".col-md-5 .wk-hot-sub-title").append(u(2,2,2,I[0].indus))}if(d("#industry-follow").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#industry-follow").find(".col-md-5 .wk-hot-sub-title").append(u(3,2,2,I[0].indus))}if(d("#concept-view").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#concept-view").find(".col-md-5 .wk-hot-sub-title").append(u(1,3,2,B[0].sect))}if(d("#concept-search").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#concept-search").find(".col-md-5 .wk-hot-sub-title").append(u(2,3,2,B[0].sect))}if(d("#concept-follow").find(".col-md-5 .wk-hot-sub-title a").length<=0){d("#concept-follow").find(".col-md-5 .wk-hot-sub-title").append(u(3,3,2,B[0].sect))}l=C.stock_info.stock_name;d(".wk-rate-select").attr("data-stock-name",l);d(".wk-toshow-name").html(l+"("+e+")");Utility.getSinaStockData(e,function(L){var M=Utility.getStockStatus(L);d(".wk-topshow-price").html("¥"+M.price).addClass(Utility.getUpDownColor(M.updown));d(".wk-topshow-price-per").html(Utility.getPriceSymbol(M.updown)+M.updown.toFixed(2)+"("+Utility.getPriceSymbol(M.updown)+M.percent.toFixed(2)+"%)").addClass(Utility.getUpDownColor(M.percent));d(".btn-group li").click(function(){var N=d(this).attr("data");switch(N){case"1":d(this).find("a").attr("href","/company/profile.php?data="+l+","+e+","+M.price+","+M.updown+","+M.percent+","+Utility.getTradeTime());break;case"2":d(this).find("a").attr("href","/company/executives.php?data="+l+","+e+","+M.price+","+M.updown+","+M.percent+","+Utility.getTradeTime());break;case"3":d(this).find("a").attr("href","/company/capital_structure.php?data="+l+","+e+","+M.price+","+M.updown+","+M.percent+","+Utility.getTradeTime());break;case"4":d(this).find("a").attr("href","/company/stockholder.php?data="+l+","+e+","+M.price+","+M.updown+","+M.percent+","+Utility.getTradeTime());break}})});d(".wk-topshow-dp label").html(Utility.getTradeTime()).addClass("wk-up");d("title").html(C.stock_info.stock_name+"("+C.stock_info.stock_code+")热度情况");d(".wk-related-info").html('热度总览&nbsp;<i class="fa fa-question-circle-o" data-toggle="popover" data-content="'+C.stock_info.stock_name+'每小时产生的热度量"></i><span>行业：'+K+"</span><span>概念："+A+"");d("#wk-top-hots .latesthot-title").html(C.stock_info.stock_name+"最近热度");d("#wk-top-hots .todayhot-title").html(C.stock_info.stock_name+"今日最热度");d("#wk-top-stockdata .latesthot-title").html(C.stock_info.stock_name+"最新行情");d("#wk-top-moneyflow .latesthot-title").html(C.stock_info.stock_name+"资金流向");d("i[data-toggle='popover']").popover({container:"body",trigger:"hover"});var D=B[0].sect;var H=I[0].indus;if(!x){common.getTopTwentyStock({hottype:"gn",hotval:D},function(){d("#concept-view .wk-hot-table tbody").html("<tr><td colspan='5'>加载中...</td></tr>")},function(L){if(L.status===1){y(L);x=L}})}else{y(x)}if(!n){common.getTopTwentyStock({hottype:"hy",hotval:H},function(){d("#industry-view .wk-hot-table tbody").html("<tr><td colspan='5'>加载中...</td></tr>")},function(L){if(L.status===1){h(L);n=L}})}else{h(n)}s();w();r()}}function h(C){var G;if(C.result.code_info.shv_.length>0){var B=C.result.code_info.shv_;var E=C.result.code_info.suv_;d("#industry-view .wk-hot-table tbody").html(common.buildHotmapTable(B,"stock"));G=Utility.buildMapTable(E);d("#industry-view .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#industry-view .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-industry-view-treemap",G._map,"stock")}if(C.result.code_info.shs_.length>0){var D=C.result.code_info.shs_;var H=C.result.code_info.sus_;d("#industry-search .wk-hot-table tbody").html(common.buildHotmapTable(D,"stock"));G=Utility.buildMapTable(H);d("#industry-search .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#industry-search .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-industry-search-treemap",G._map,"stock")}if(C.result.code_info.shf_.length>0){var F=C.result.code_info.shf_;var A=C.result.code_info.suf_;d("#industry-follow .wk-hot-table tbody").html(common.buildHotmapTable(F,"stock"));G=Utility.buildMapTable(A);d("#industry-follow .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#industry-follow .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-industry-follow-treemap",G._map,"stock")}}function y(C){var G;if(C.result.code_info.shv_.length>0){var B=C.result.code_info.shv_;var E=C.result.code_info.suv_;d("#concept-view .wk-hot-table tbody").html(common.buildHotmapTable(B,"stock"));G=Utility.buildMapTable(E);d("#concept-view .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#concept-view .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-concept-view-treemap",G._map,"stock")}if(C.result.code_info.shs_.length>0){var D=C.result.code_info.shs_;var H=C.result.code_info.sus_;d("#concept-search .wk-hot-table tbody").html(common.buildHotmapTable(D,"stock"));G=Utility.buildMapTable(H);d("#concept-search .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#concept-search .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-concept-search-treemap",G._map,"stock")}if(C.result.code_info.shf_.length>0){var F=C.result.code_info.shf_;var A=C.result.code_info.suf_;d("#concept-follow .wk-hot-table tbody").html(common.buildHotmapTable(F,"stock"));G=Utility.buildMapTable(A);d("#concept-follow .right .toggle-treemap-table-up tbody").html(common.buildStockTable(G._up));d("#concept-follow .right .toggle-treemap-table-down tbody").html(common.buildStockTable(G._down));common.buildHotmap("wk-concept-follow-treemap",G._map,"stock")}}function s(){var B=echarts.init(o.getElementById("wk-rate-line-pic"));var A={query_type:"stock",query_key:e,query_date:"today"};common.getRateLine(A,function(){B.showLoading({text:"加载中..."})},function(C){common.buildRateLine(l,"today",C);B.hideLoading()})}function w(){inforcenter.showGroup(null,function(A){if(A&&A.status===1){var C=[];C.push("<div class=\"btn-group\" style='float: right;'>");if(d(".wk-topshow-right .btn-group").length<=0){C.push('<button type="button" class="btn dropdown-toggle wk-btn-follow" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">');C.push("+ 关注");C.push("</button>");C.push('<ul class="dropdown-menu">');C.push("<li class='wk-follow-stock' data-follow-name='我的自选股'><a href=\"#\">我的自选股</a></li>");if(A.result.info.group_name.length>0){var D=A.result.info.group_name;for(var B=0;B<D.length;B++){C.push("<li class='wk-follow-stock' data-follow-name='"+D[B]+'\'><a href="#">'+D[B]+"</a></li>")}C.push('<li class="wk-follow-stock" id=\'addNewGroup\' data-follow-name="addNewGroup"><a href="javascript:">添加组合</a></li>')}d(".wk-topshow-right").append(C.join(""));C.push("</ul>");C.push("</div>")}k()}})}function k(){d(".wk-follow-stock").each(function(){var A=d(this).attr("data-follow-name");d(this).unbind("click").bind("click",function(){if(A==="addNewGroup"){swal({title:"添加组合",text:"组合名称不能超过6个汉字或12个字符",type:"input",html:true,showCancelButton:true,closeOnConfirm:false,confirmButtonText:"确定",cancelButtonText:"取消",animation:"slide-from-top",inputPlaceholder:"请输入组合名称"},function(B){if(B===false){return false}if(B===""){swal.showInputError("请输入组合名称");return false}if(Utility.getByteLen(B)>12){swal.showInputError("字符数超过限制");return false}inforcenter.addGroup({ori_name:B},null,function(C){if(C.status==1){swal({title:"",text:"添加<span style='color: #F8BB86'>"+B+"</span>组合成功",html:true,timer:1000,showConfirmButton:false});d("#addNewGroup").before("<li class='wk-follow-stock' data-follow-name='"+B+'\'><a href="#">'+B+"</a></li>");z(B,e,false);k()}else{if(C.status==0){swal({title:"",text:"添加<span style='color: #F8BB86'>"+B+"</span>组合异常,"+C.msg+"",html:true,timer:1000,showConfirmButton:false})}}})})}else{z(A,e,true)}})})}function z(C,B,A){inforcenter.addStock({ori_name:C,code:B},null,function(D){if(D.status===1){if(A){swal({title:"",text:"关注个股<span style='color: #F8BB86'>"+B+"</span>成功",html:true,timer:1000,showConfirmButton:false})}}else{if(D.status===0){swal({title:"",text:"关注个股<span style='color: #F8BB86'>"+B+"</span>异常,"+D.msg+"",html:true,timer:1000,showConfirmButton:false})}else{swal({title:"",text:"关注个股<span style='color: #F8BB86'>"+B+"</span>异常,未知原因",html:true,timer:1000,showConfirmButton:false})}}})}function r(){common.initRelateSHG(1,e,function(B){if(B&&B.status===1){var C=[];if(B.industry&&B.industry.length>0){C.push('{ "industry": "'+B.industry[0].industry+'", "concept": "'+B.notion[0].section+'" }')}var A=l+"("+e+")";common.buildReleatedInfoChart(A,B)}})}function b(){d(".modal-chart").modal("show");var A=echarts.init(o.getElementById("modal-chart"));common.getSingleRealTimeHot({stock:e},function(){A.showLoading({text:"加载中..."})},function(E){A.hideLoading();var D=[];var F=[];if(E.status===1){if(E.visit){for(var C in E.visit){if(E.visit.hasOwnProperty(C)){D.push(E.visit[C]);F.push('"'+Utility.numToTime(C)+'"')}}F=JSON.parse("["+F.join(",")+"]");D=JSON.parse("["+D.join(",")+"]")}var B=echarts.init(o.getElementById("modal-chart"));B.showLoading({text:"加载中..."});B.setOption({color:["rgb(243, 104, 97)"],tooltip:{trigger:"axis",formatter:function(I){var G="";G+=I[0].name+"<br>";for(var H in I){if(I.hasOwnProperty(H)){if(I[H].value&&I[H].value!==0){if(I[0].name===I[H].name){G+="<label style='color: "+I[H].color+";font-size: 14x;'>●</label>&nbsp;&nbsp;"+I[H].seriesName+":"+Utility.formatNum(I[H].value)+"<br>"}}}}return G}},dataZoom:[{type:"inside",realtime:true},{type:"slider",show:true,realtime:true}],grid:{top:10,left:20,right:20,bottom:40,containLabel:true},legend:{left:"left"},xAxis:{type:"category",boundaryGap:false,data:F},yAxis:{type:"value",position:"right",scale:true},calculable:false,series:[{name:"查看",type:"line",smooth:true,data:D}]});B.hideLoading();j.onresize=B.resize}})}function m(){d("#wk-show-chart-tip").html("<label>当前价：<span>--</span></label><label>成交量：<span>--</span>股</label><label>时间：<span>--</span></label><label>涨幅：<span>--</span></label>");var A=echarts.init(o.getElementById("left-stockdata-chart"));common.getCurve({code:e},function(){A.showLoading({text:"加载中..."})},function(E){var D=[];var C=[];var H=[];if(E.status===1){A.hideLoading();var G=E.result.code_info||[];if(G.length>0){for(var F=0,B=G.length;F<B;F++){H.push(Utility.unixToTime(G[F].time*1000));C.push(G[F].price);D.push({price:G[F].price,average_price:G[F].average_price,pcr:G[F].price_change_ratio,volume:G[F].volume,time:G[F].time})}}A.setOption({color:["rgb(12, 145, 179)"],tooltip:{trigger:"axis",formatter:function(L){var J=D[L[0].dataIndex];var I="";I+=L[0].name+"<br>";for(var K in L){if(L.hasOwnProperty(K)){if(L[K].value&&L[K].value!==0){if(L[0].name===L[K].name){I+="<label style='color: "+L[K].color+";font-size: 12x;'>●</label>&nbsp;&nbsp;"+L[K].seriesName+":"+Utility.formatNum(L[K].value)+"<br>"}}}}d("#wk-show-chart-tip").html("<label>当前价:<span class='"+Utility.getPriceColor(J.pcr)+"'>"+J.price+"</span></label><label>成交量:<span>"+(J.volume).toChineseNum()+"</span>股</label><label>时间:<span>"+Utility.unixToTime(J.time*1000)+"</span></label><label>涨幅：<span class='"+Utility.getPriceColor(J.pcr)+"'>"+Utility.getPriceSymbol(J.pcr)+""+J.pcr+"</span></label>");d(".wk-top-panelcon").mouseleave(function(){d("#wk-show-chart-tip").html("<label>当前价：<span>--</span></label><label>成交量：<span>--</span>股</label><label>时间：<span>--</span></label><label>涨幅：<span>--</span></label>")});return I}},grid:{top:"10px",left:"3%",right:"3%",bottom:10,containLabel:true},xAxis:{type:"category",boundaryGap:false,data:H,axisLabel:{interval:60}},yAxis:{type:"value",position:"right",scale:true},calculable:false,series:[{name:"大盘数据",type:"line",smooth:true,showSymbol:false,symbolSize:2,data:D.map(function(I){return I.price}),lineStyle:{normal:{width:1}}}]});j.onresize=A.resize}});common.getGrail({code:e},null,function(D){var C=[];if(D.status===1){var B=D.result.code_info;C.push("<tr><td>今开：<span>"+B.open.toFixed(2)+"</span></td><td>换手率：<span>"+B.amount.toFixed(2)+"</span></td></tr>");C.push("<tr><td>昨收：<span>"+B.settlement_.toFixed(2)+"</span></td><td>每股收益：<span>"+B.eps.toFixed(2)+"</span></td></tr>");C.push("<tr><td>最高：<span>"+B.high.toFixed(2)+"</span></td><td>总股本：<span>"+(B.totals*10000).toChineseNum()+"</span></td></tr>");C.push("<tr><td>最低：<span>"+B.low.toFixed(2)+"</span></td><td>总市值：<span>"+(B.zsz*10000).toChineseNum()+"</span></td></tr>");C.push("<tr><td>市盈率：<span>"+B.pe.toFixed(2)+"</span></td><td>流通市值：<span>"+(B.ltsz*10000).toChineseNum()+"</span></td></tr>");C.push("<tr><td>市净率：<span>"+B.pb.toFixed(2)+"</span></td><td>成交量：<span>"+(B.volume).toChineseNum()+"股</span></td></tr>");d("#wk-top-stockdata .right-infos table>tbody").html(C.join(""))}})}var g={query_type:1,key:e,start_id:0,info_type_list:"",start_time:0};d(".nav-tabs li a").bind("click",function(){if(d(this).attr("href").indexOf("#wk-selfmedia")===0){if(d("#mCSB_2_container").html().trim()===""){g.start_id=0;g.start_time=0;common.getSelfMedia(g,true)}}if(d(this).attr("href").indexOf("#wk-newsflash")===0){if(d("#wk-newsflash table>tbody").html().trim()===""){g.start_id=0;g.start_time=0;common.getFastNews(g,true)}}if(d(this).attr("href").indexOf("#wk-notice")===0){if(d("#mCSB_4_container").html().trim()===""){g.start_id=0;common.getNotice(g,true)}}if(d(this).attr("href").indexOf("#wk-report")===0){if(d("#mCSB_5_container").html().trim()===""){g.start_id=0;common.getReports(g,true)}}});d("#wk-news").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(d("#wk-news .wk-news-list:last").attr("id")){g.start_id=d("#wk-news .wk-news-list:last").attr("id").replace("news_","");g.info_type_list="1,0,0,0,0,0";g.timestamp=d("#wk-news .wk-news-list:last").attr("data-news-timestamp");common.getNews(g)}}}});d("#wk-selfmedia").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(d("#wk-selfmedia .wk-news-list:last").attr("id")){g.start_id=d("#wk-selfmedia .wk-news-list:last").attr("id").replace("media_","");g.info_type_list="0,0,1,0,0,0";g.timestamp=d("#wk-selfmedia .wk-news-list:last").attr("data-media-timestamp");common.getSelfMedia(g)}}}});d("#wk-newsflash").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(d("#wk-newsflash .wk-user-fastnews:last-child").find("ul li:last-child").attr("id")){g.start_id=d("#wk-newsflash .wk-user-fastnews:last-child").find("ul li:last-child").attr("id").replace("fast_","");g.info_type_list="0,1,0,0,0,0";g.timestamp=d("#wk-newsflash  .wk-user-fastnews:last-child").find("ul li:last-child").attr("data-fastnews-timestamp");common.getFastNews(g)}}}});d("#wk-notice").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(d("#wk-notice .wk-news-list:last").attr("id")){g.start_id=d("#wk-notice .wk-news-list:last").attr("id").replace("notice_","");g.info_type_list="0,0,0,0,0,0,1";g.timestamp=d("#wk-notice .wk-news-list:last").attr("data-news-timestamp");common.getNotice(g)}}}});d("#wk-report").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(d("#wk-report .wk-news-list:last").attr("id")){g.start_id=d("#wk-report .wk-news-list:last").attr("id").replace("report_","");g.info_type_list="0,0,0,0,0,0,0,1";g.timestamp=d("#wk-report .wk-news-list:last").attr("data-news-timestamp");common.getNotice(g)}}}});d(".wk-line-toggle a").click(function(){d(this).addClass("line-active").siblings().removeClass("line-active");var A=d(this).parent().attr("data-query-type");var C=d(this).parent().attr("data-query-key");var D=d(this).attr("data-key");var B={query_type:A,key_name:C,time_type:D};if(D==="minute"){b();return}if(D==="day"){common.getLineChart("left-hot-chart",a,p,c,t)}else{common.getHotRecord(B,function(){var E=echarts.init(o.getElementById("left-hot-chart"));E.showLoading({text:"加载中..."})},function(H){var L=[];var G=[];var J=[];var E=[];if(H.status===1){for(var O in H.visit){if(H.visit.hasOwnProperty(O)){var M=H.visit[O];for(var N in M){if(M.hasOwnProperty(N)){E.push(N);L.push(M[N])}}}}for(var R in H.search){if(H.search.hasOwnProperty(R)){var Q=H.search[R];for(var P in Q){if(Q.hasOwnProperty(P)){G.push(Q[P])}}}}for(var K in H.follow){if(H.follow.hasOwnProperty(K)){var I=H.follow[K];for(var F in I){if(I.hasOwnProperty(F)){J.push(I[F])}}}}}common.getLineChart("left-hot-chart",E,L,G,J)})}});d(".treemap-toggle span").click(function(){d(this).addClass("treemap-active").siblings().removeClass("treemap-active");var A=d(this).parent().parent().parent();if(d(this).html()==="热力图"){A.find(".toggle-treemap").show();A.find(".toggle-treemap-table-up").hide();A.find(".toggle-treemap-table-down").hide()}else{if(d(this).html()==="涨幅"){A.find(".toggle-treemap").hide();A.find(".toggle-treemap-table-up").show();A.find(".toggle-treemap-table-down").hide()}else{if(d(this).html()==="跌幅"){A.find(".toggle-treemap").hide();A.find(".toggle-treemap-table-up").hide();A.find(".toggle-treemap-table-down").show()}}}});d(".wk-rate-select label").click(function(){d(this).addClass("active").siblings().removeClass("active");var E=d(this).parent().attr("data-query-name");var C=d(this).parent().attr("data-query-type");var A=d(this).attr("data-toggle");var D=echarts.init(o.getElementById("wk-rate-line-pic"));var B={query_type:C,query_key:E,query_date:A};if(C==="stock"){if(l){E=l}}switch(A){case"today":common.getRateLine(B,function(){D.showLoading({text:"加载中..."})},function(F){common.buildRateLine(E,A,F);D.hideLoading()});break;case"week":common.getRateLine(B,function(){D.showLoading({text:"加载中..."})},function(F){common.buildRateLine(E,A,F);D.hideLoading()});break;case"month":common.getRateLine(B,function(){D.showLoading({text:"加载中..."})},function(F){common.buildRateLine(E,A,F);D.hideLoading()});break;case"threemonth":common.getRateLine(B,function(){D.showLoading({text:"加载中..."})},function(F){common.buildRateLine(E,A,F);D.hideLoading()});break;case"datacompare":common.getRateLine(B,function(){D.showLoading({text:"加载中..."})},function(F){D.hideLoading();f(F)});break;default:break}});function f(I){var A=[];var G=[];var D=[];var B=[];if(I.body&&I.body.list.length>0){var H=I.body.list;for(var E=0;E<H.length;E++){A.push(Utility.unixToTime(H[E].trade_time*1000));G.push(H[E].day_yield);D.push(H[E].hs300_day_yield);B.push(H[E].visit)}}var C=echarts.init(o.getElementById("wk-rate-line-pic"));var F={tooltip:{trigger:"axis",formatter:function(L){var J="";J+=L[0].name+"<br>";for(var K in L){if(L.hasOwnProperty(K)){if(L[K].seriesName!=="查看热度"){if(L[K].value&&L[K].value!==0){if(L[0].name===L[K].name){J+="<label style='color: "+L[K].color+";font-size: 14px;'>●</label>&nbsp;&nbsp;"+L[K].seriesName+":"+(L[K].value*100).toFixed(2)+"%<br>"}}}else{J+="<label style='color: "+L[K].color+";font-size: 14px;'>●</label>&nbsp;&nbsp;"+L[K].seriesName+":"+L[K].value+"<br>"}}}return J}},color:["rgb(151,47,134)","rgb(65,77,92)","rgb(250,100,100)"],legend:{data:["收益率","沪深300","查看热度"],top:0},grid:{top:"25px",left:0,right:0,bottom:0,containLabel:true},xAxis:{type:"category",boundaryGap:false,data:A,axisLabel:{interval:10}},yAxis:[{type:"value",position:"right",axisLabel:{formatter:function(J){if(J!==0){return(J*100).toFixed(2)+"%"}else{return 0}}}},{type:"value",position:"left"}],series:[{name:"收益率",type:"line",smooth:true,yAxisIndex:0,data:JSON.parse("["+G+"]"),lineStyle:{normal:{width:1.5}}},{name:"沪深300",type:"line",smooth:true,yAxisIndex:0,data:JSON.parse("["+D+"]"),lineStyle:{normal:{width:1.5}}},{name:"查看热度",type:"line",smooth:true,yAxisIndex:1,data:JSON.parse("["+B+"]"),lineStyle:{normal:{width:1.5}}}]};C.setOption(F);j.onresize=C.resize}d(".wk-topcharts-box ul>li>a").bind("click",function(){if(d(this).attr("aria-controls")==="wk-top-stockdata"){m()}});common.getStockBase({stock:e},function(){},function(A){v(A);d('.wk-hotmap a[data-toggle="tab"]').on("shown.bs.tab",function(){v(A)})});common.getNews(g,true);q();common.initdoubleLine(1,i)})(jQuery,window,document);