var name=Utility.getQueryStringByName("name");var xdata=["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24：00"];var wk_treemap_data,viewData=[],searchData=[],followData=[];var myChart=echarts.init(document.getElementById("left-chart"));myChart.showLoading();function initLineChart(){common.getHyAndGnHot({name:name,query_type:2},null,function(b){if(b.status==1){var c=[];var a=[];if(b.visit){var i=0;for(var n in b.visit){viewData.push(b.visit[n]);i++}viewData=JSON.parse("["+viewData.join(",")+"]");var m=Math.max.apply(Math,viewData);var e=viewData.indexOf(Math.max.apply(Math,viewData));a.push("<tr><td>查看</td><td>"+viewData[viewData.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+i+":00")+"</td></tr>");c.push("<tr><td>查看</td><td>"+m+"</td><td>"+Utility.calTime(e)+"</td></tr>")}if(b.search){var d=0;for(var p in b.search){searchData.push(b.search[p]);d++}searchData=JSON.parse("["+searchData.join(",")+"]");var o=Math.max.apply(Math,searchData);var g=searchData.indexOf(Math.max.apply(Math,searchData));a.push("<tr><td>查看</td><td>"+searchData[searchData.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+d+":00")+"</td></tr>");c.push("<tr><td>搜索</td><td>"+o+"</td><td>"+Utility.calTime(g)+"</td></tr>")}if(b.follow){var l=0;for(var k in b.follow){followData.push(b.follow[k]);l++}followData=JSON.parse("["+followData.join(",")+"]");var j=Math.max.apply(Math,followData);var h=followData.indexOf(Math.max.apply(Math,followData));a.push("<tr><td>查看</td><td>"+followData[followData.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+l+":00")+"</td></tr>");c.push("<tr><td>关注</td><td>"+j+"</td><td>"+Utility.calTime(h)+"</td></tr>")}$(".todayhot").html(c.join(""));$(".latesthot").html(a.join(""));common.getLineChart("left-chart",xdata,viewData,searchData,followData)}})}function initTreeMapChart(){if(!wk_treemap_data){common.getTopTwentyStock({hottype:"gn",hotval:name},function(){var a=echarts.init(document.getElementById("wk-stock-view-treemap"));a.showLoading();$("#concept-view .wk-hot-table tbody").html("<tr><td colspan='5'>加载中...</td></tr>")},function(a){if(a.status==1){buildTreeMap(a);wk_treemap_data=a}})}else{buildTreeMap(wk_treemap_data)}}function buildTreeMap(c){if(c.result.code_info.shv_.length>0){var d=c.result.code_info.shv_;var f=c.result.code_info.suv_;$("#concept-view .wk-hot-table tbody").html(common.buildHotmapTable(d,"stock"));$("#concept-view .right .wk-treemap-table tbody").html(common.buildStockTable(f));common.buildHotmap("wk-stock-view-treemap",f,"stock")}if(c.result.code_info.shs_.length>0){var e=c.result.code_info.shs_;var a=c.result.code_info.sus_;$("#concept-search .wk-hot-table tbody").html(common.buildHotmapTable(e,"stock"));$("#concept-search .right .wk-treemap-table tbody").html(common.buildStockTable(a));common.buildHotmap("wk-stock-search-treemap",a,"stock")}if(c.result.code_info.shf_.length>0){var g=c.result.code_info.shf_;var b=c.result.code_info.suf_;$("#concept-follow .wk-hot-table tbody").html(common.buildHotmapTable(g,"stock"));$("#concept-follow .right .wk-treemap-table tbody").html(common.buildStockTable(b));common.buildHotmap("wk-stock-follow-treemap",b,"stock")}}$(function(){var a={query_type:3,key:name,start_id:0,info_type_list:"",start_time:0};$(".nav-tabs li a").bind("click",function(){if($(this).attr("href").indexOf("#wk-selfmedia")==0){if($("#mCSB_2_container").html().trim()==""){a.start_id=0;common.getSelfMedia(a)}}if($(this).attr("href").indexOf("#wk-newsflash")==0){if($("#wk-newsflash table>tbody").html().trim()==""){a.start_id=0;common.getFastNews(a)}}});$("#wk-news").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScrollOffset:150,onTotalScroll:function(){a.start_id=$("#wk-news .wk-news-list:last").attr("id").replace("news_","");a.info_type_list="1,0,0,0,0,0";a.timestamp=$("#wk-news .wk-news-list:last").attr("data-news-timestamp");common.getNews(a)}}});$("#wk-selfmedia").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScrollOffset:150,onTotalScroll:function(){a.start_id=$("#wk-selfmedia .wk-news-list:last").attr("id").replace("media_","");a.info_type_list="0,0,1,0,0,0";a.timestamp=$("#wk-selfmedia .wk-news-list:last").attr("data-news-timestamp");common.getSelfMedia(a)}}});$("#wk-newsflash").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScrollOffset:150,onTotalScroll:function(){a.start_id=$("#wk-newsflash .wk-news-list tr:last").attr("id").replace("fast_","");a.info_type_list="0,1,0,0,0,0";a.timestamp=$("#wk-newsflash .wk-news-list:last").attr("data-news-timestamp");common.getFastNews(a)}}});common.initRelateSHG(3,name);common.getNews(a);initLineChart();initTreeMapChart()});