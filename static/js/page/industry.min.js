"use strict";(function(f,h,l){var t=Utility.getQueryStringByName("name");var a=["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24：00"];var c,m=[],e=[],r=[],b=[],n=[],i=[];var d=echarts.init(l.getElementById("left-chart"));d.showLoading({text:"加载中..."});var j=echarts.init(l.getElementById("left-double-chart"));j.showLoading({text:"加载中..."});function o(){common.getHyAndGnHot({name:t,query_type:1},null,function(w){if(w.status==1){var x=[];var u=[];if(w.visit){var C=0;for(var H in w.visit){m.push(w.visit[H]);C++}m=JSON.parse("["+m.join(",")+"]");var G=Math.max.apply(Math,m);var z=m.indexOf(Math.max.apply(Math,m));u.push("<tr><td>查看</td><td>"+m[m.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(C-1)+":00")+"</td></tr>");x.push("<tr><td>查看</td><td>"+G+"</td><td>"+Utility.calTime(z)+"</td></tr>")}if(w.search){var y=0;for(var J in w.search){e.push(w.search[J]);y++}e=JSON.parse("["+e.join(",")+"]");var I=Math.max.apply(Math,e);var A=e.indexOf(Math.max.apply(Math,e));u.push("<tr><td>搜索</td><td>"+e[e.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(y-1)+":00")+"</td></tr>");x.push("<tr><td>搜索</td><td>"+I+"</td><td>"+Utility.calTime(A)+"</td></tr>")}if(w.follow){var F=0;for(var E in w.follow){r.push(w.follow[E]);F++}r=JSON.parse("["+r.join(",")+"]");var D=Math.max.apply(Math,r);var B=r.indexOf(Math.max.apply(Math,r));u.push("<tr><td>关注</td><td>"+r[r.length-1]+"</td><td>"+(Utility.getNowFormatDate()+" "+(F-1)+":00")+"</td></tr>");x.push("<tr><td>关注</td><td>"+D+"</td><td>"+Utility.calTime(B)+"</td></tr>")}f(".todayhot").html(x.join(""));f(".latesthot").html(u.join(""));common.getLineChart("left-chart",a,m,e,r)}})}function s(){if(!c){common.getTopTwentyStock({hottype:"hy",hotval:t},function(){var u=echarts.init(l.getElementById("wk-stock-view-treemap"));u.showLoading({text:"加载中..."});f("#industry-view .wk-hot-table tbody").html("<tr><td colspan='5'>加载中...</td></tr>")},function(u){if(u.status==1){p(u);c=u}})}else{p(c)}}function p(w){if(w.result.code_info.shv_.length>0){var x=w.result.code_info.shv_;var z=w.result.code_info.suv_;f("#industry-view .wk-hot-table tbody").html(common.buildHotmapTable(x,"stock"));var B=Utility.buildMapTable(z);f("#industry-view .right .toggle-treemap-table-up tbody").html(common.buildStockTable(B._up));f("#industry-view .right .toggle-treemap-table-down tbody").html(common.buildStockTable(B._down));common.buildHotmap("wk-stock-view-treemap",B._map,"stock")}if(w.result.code_info.shs_.length>0){var y=w.result.code_info.shs_;var u=w.result.code_info.sus_;f("#industry-search .wk-hot-table tbody").html(common.buildHotmapTable(y,"stock"));var B=Utility.buildMapTable(u);f("#industry-search .right .toggle-treemap-table-up tbody").html(common.buildStockTable(B._up));f("#industry-search .right .toggle-treemap-table-down tbody").html(common.buildStockTable(B._down));common.buildHotmap("wk-stock-search-treemap",B._map,"stock")}if(w.result.code_info.shf_.length>0){var A=w.result.code_info.shf_;var v=w.result.code_info.suf_;f("#industry-follow .wk-hot-table tbody").html(common.buildHotmapTable(A,"stock"));var B=Utility.buildMapTable(v);f("#industry-follow .right .toggle-treemap-table-up tbody").html(common.buildStockTable(B._up));f("#industry-follow .right .toggle-treemap-table-down tbody").html(common.buildStockTable(B._down));common.buildHotmap("wk-stock-follow-treemap",B._map,"stock")}}function q(){var v=echarts.init(l.getElementById("wk-rate-line-pic"));var u={query_type:"industry",query_key:t,query_date:"today"};common.getRateLine(u,function(){v.showLoading({text:"加载中..."})},function(w){common.buildRateLine(decodeURI(t),"today",w);v.hideLoading()})}function k(v,u){common.getNewsTrend({query_type:v,key_name:u},null,function(w){j.hideLoading();if(w.status==1){for(var y=0,x=w.infotrend.length;y<x;y++){b.push(w.infotrend[y]["date"]);n.push(w.infotrend[y]["info_count"]);i.push(w.infotrend[y]["info_senti"])}if(w.senti_per){var z=w.senti_per.neg_per;var A=w.senti_per.pos_per;f(".pro_chart .progress_neg_per").css("width",z*100+"%");if(z&&z>0){f(".pro_chart .progress_neg .progress_circle").css({left:(z*100)-1.5+"%",display:"block"})}f(".sacle .negative_per").html((z*100).toFixed(0));f(".pro_chart .progress_pos_per").css("width",A*100+"%");if(A&&A>0){f(".pro_chart .progress_pos .progress_circle").css({left:(A*100)-1.5+"%",display:"block"})}f(".sacle .positive_per").html((A*100).toFixed(0))}common.getTwoLineChart("left-double-chart",b,n,i)}})}var g={query_type:2,key:t,start_id:0,info_type_list:"",start_time:0};f(".nav-tabs li a").bind("click",function(){if(f(this).attr("href").indexOf("#wk-selfmedia")==0){if(f("#mCSB_2_container").html().trim()==""){g.start_id=0;common.getSelfMedia(g,true)}}if(f(this).attr("href").indexOf("#wk-newsflash")==0){if(f("#wk-newsflash table>tbody").html().trim()==""){g.start_id=0;common.getFastNews(g,true)}}if(f(this).attr("href").indexOf("#wk-notice")==0){if(f("#mCSB_4_container").html().trim()==""){g.start_id=0;common.getNotice(g,true)}}if(f(this).attr("href").indexOf("#wk-report")==0){if(f("#mCSB_5_container").html().trim()==""){g.start_id=0;common.getReports(g,true)}}});f("#wk-news").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(f("#wk-news .wk-news-list:last").attr("id")){g.start_id=f("#wk-news .wk-news-list:last").attr("id").replace("news_","");g.info_type_list="1,0,0,0,0,0";g.timestamp=f("#wk-news .wk-news-list:last").attr("data-news-timestamp");common.getNews(g)}}}});f("#wk-selfmedia").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(f("#wk-selfmedia .wk-news-list:last").attr("id")){g.start_id=f("#wk-selfmedia .wk-news-list:last").attr("id").replace("media_","");g.info_type_list="0,0,1,0,0,0";g.timestamp=f("#wk-selfmedia .wk-news-list:last").attr("data-media-timestamp");common.getSelfMedia(g)}}}});f("#wk-newsflash").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(f("#wk-newsflash .wk-user-fastnews:last-child").find("ul li:last-child").attr("id")){g.start_id=f("#wk-newsflash .wk-user-fastnews:last-child").find("ul li:last-child").attr("id").replace("fast_","");g.info_type_list="0,1,0,0,0,0";g.timestamp=f("#wk-newsflash  .wk-user-fastnews:last-child").find("ul li:last-child").attr("data-fastnews-timestamp");common.getFastNews(g)}}}});f("#wk-notice").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(f("#wk-notice .wk-news-list:last").attr("id")){g.start_id=f("#wk-notice .wk-news-list:last").attr("id").replace("notice_","");g.info_type_list="0,0,0,0,0,0,1";g.timestamp=f("#wk-notice .wk-news-list:last").attr("data-news-timestamp");common.getNotice(g)}}}});f("#wk-report").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){if(f("#wk-report .wk-news-list:last").attr("id")){g.start_id=f("#wk-report .wk-news-list:last").attr("id").replace("report_","");g.info_type_list="0,0,0,0,0,0,0,1";g.timestamp=f("#wk-report .wk-news-list:last").attr("data-news-timestamp");common.getReports(g)}}}});common.initRelateSHG(2,t);common.getNews(g,true);o();s();q();k(2,t)})(jQuery,window,document);