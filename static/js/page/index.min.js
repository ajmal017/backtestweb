var wk_treemap_data,viewData=[],searchData=[],followData=[];var xdata=["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24：00"];var myLineChart=echarts.init(document.getElementById("left-chart"));myLineChart.showLoading();function initTreeMapChart(){if(!wk_treemap_data){common.getTopTwentyStock(null,function(){var c=["wk-stock-view-treemap","wk-industry-view-treemap","wk-concept-view-treemap"];for(var a in c){var b=echarts.init(document.getElementById(c[a]));b.showLoading()}},function(a){if(a.status==1){buildTreeMap(a);wk_treemap_data=a}})}else{buildTreeMap(wk_treemap_data)}}function buildTreeMap(e){if(e.result.code_info.shv_.length>0){var n=e.result.code_info.shv_;var d=e.result.code_info.suv_;$("#hot-view-stock").html("<a class='"+Utility.getPriceColor(n[0].price)+"' href='stocks.php?stock="+n[0].code+"' target='_blank'>"+n[0].name+"("+n[0].code+")</a>");$("#stock-view .wk-hot-table tbody").html(common.buildHotmapTable(n,"stock"));$("#stock-view .right .wk-treemap-table tbody").html(common.buildStockTable(d));common.buildHotmap("wk-stock-view-treemap",d,"stock")}if(e.result.code_info.shs_.length>0){var o=e.result.code_info.shs_;var f=e.result.code_info.sus_;$("#hot-search-stock").html("<a class='"+Utility.getPriceColor(o[0].price)+"' href='stocks.php?stock="+o[0].code+"' target='_blank'>"+o[0].name+"("+o[0].code+")</a>");$("#stock-search .wk-hot-table tbody").html(common.buildHotmapTable(o,"stock"));$("#stock-search .right .wk-treemap-table tbody").html(common.buildStockTable(f));common.buildHotmap("wk-stock-search-treemap",f,"stock")}if(e.result.code_info.shf_.length>0){var s=e.result.code_info.shf_;var i=e.result.code_info.suf_;$("#hot-follow-stock").html("<a class='"+Utility.getPriceColor(s[0].price)+"' href='stocks.php?stock="+s[0].code+"' target='_blank'>"+s[0].name+"("+s[0].code+")</a>");$("#stock-follow .wk-hot-table tbody").html(common.buildHotmapTable(s,"stock"));$("#stock-follow .right .wk-treemap-table tbody").html(common.buildStockTable(i));common.buildHotmap("wk-stock-follow-treemap",i,"stock")}if(e.result.code_info.hhv_.length>0){var l=e.result.code_info.hhv_;var r=e.result.code_info.huv_;$("#industry-view .wk-hot-table tbody").html(common.buildHotmapTable(l,"industry"));$("#industry-view .right .wk-treemap-table tbody").html(common.buildOtherTable(r,"industry"));common.buildHotmap("wk-industry-view-treemap",r,"industry")}if(e.result.code_info.hhs_.length>0){var m=e.result.code_info.hhs_;var b=e.result.code_info.hus_;$("#industry-search .wk-hot-table tbody").html(common.buildHotmapTable(m,"industry"));$("#industry-search .right .wk-treemap-table tbody").html(common.buildOtherTable(b,"industry"));common.buildHotmap("wk-industry-search-treemap",b,"industry")}if(e.result.code_info.hhf_.length>0){var q=e.result.code_info.hhf_;var g=e.result.code_info.huf_;$("#industry-follow .wk-hot-table tbody").html(common.buildHotmapTable(q,"industry"));$("#industry-follow .right .wk-treemap-table tbody").html(common.buildOtherTable(g,"industry"));common.buildHotmap("wk-industry-follow-treemap",g,"industry")}if(e.result.code_info.ghv_.length>0){var a=e.result.code_info.ghv_;var j=e.result.code_info.guv_;$("#concept-view .wk-hot-table tbody").html(common.buildHotmapTable(a,"concept"));$("#concept-view .right .wk-treemap-table tbody").html(common.buildOtherTable(j,"concept"));common.buildHotmap("wk-concept-view-treemap",j,"concept")}if(e.result.code_info.ghs_.length>0){var c=e.result.code_info.ghs_;var k=e.result.code_info.gus_;$("#concept-search .wk-hot-table tbody").html(common.buildHotmapTable(c,"concept"));$("#concept-search .right .wk-treemap-table tbody").html(common.buildOtherTable(k,"concept"));common.buildHotmap("wk-concept-search-treemap",k,"concept")}if(e.result.code_info.ghf_.length>0){var h=e.result.code_info.ghf_;var p=e.result.code_info.guf_;$("#concept-follow .wk-hot-table tbody").html(common.buildHotmapTable(h,"concept"));$("#concept-follow .right .wk-treemap-table tbody").html(common.buildOtherTable(p,"concept"));common.buildHotmap("wk-concept-follow-treemap",p,"concept")}}function initTimeLine(){common.getRealTimeHot(null,null,function(a){if(a.status==1){var b=[];if(a.visit){for(var j in a.visit){viewData.push(a.visit[j])}viewData=JSON.parse("["+viewData.join(",")+"]");var i=Math.max.apply(Math,viewData);var c=viewData.indexOf(Math.max.apply(Math,viewData));b.push("<tr><td>查看</td><td>"+i+"</td><td>"+Utility.calTime(c)+"</td></tr>")}if(a.search){for(var l in a.search){searchData.push(a.search[l])}searchData=JSON.parse("["+searchData.join(",")+"]");var k=Math.max.apply(Math,searchData);var d=searchData.indexOf(Math.max.apply(Math,searchData));b.push("<tr><td>搜索</td><td>"+k+"</td><td>"+Utility.calTime(d)+"</td></tr>")}if(a.follow){for(var h in a.follow){followData.push(a.follow[h])}followData=JSON.parse("["+followData.join(",")+"]");var g=Math.max.apply(Math,followData);var e=followData.indexOf(Math.max.apply(Math,followData));b.push("<tr><td>关注</td><td>"+g+"</td><td>"+Utility.calTime(e)+"</td></tr>")}$(".todayhot").html(b.join(""));common.getLineChart("left-chart",xdata,viewData,searchData,followData)}})}$(function(){initTreeMapChart();initTimeLine()});