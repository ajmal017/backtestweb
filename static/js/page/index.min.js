var wk_treemap_data,viewData=[],searchData=[],followData=[];var xdata=["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24：00"];var myLineChart=echarts.init(document.getElementById("left-chart"));myLineChart.showLoading({text:"加载中..."});function initTreeMapChart(){if(!wk_treemap_data){common.getTopTwentyStock(null,function(){var c=["wk-stock-view-treemap","wk-industry-view-treemap","wk-concept-view-treemap","wk-event-view-treemap"];for(var a in c){var b=echarts.init(document.getElementById(c[a]));b.showLoading({text:"加载中..."})}},function(a){if(a.status==1){buildTreeMap(a);wk_treemap_data=a}})}else{buildTreeMap(wk_treemap_data)}}function buildTreeMap(e){if(e.result.code_info.shv_.length>0){var q=e.result.code_info.shv_;var d=e.result.code_info.suv_;$("#hot-view-stock").html("<a class='"+Utility.getPriceColor(q[0].price)+"' href='stocks.php?stock="+q[0].code+"' target='_blank'>"+q[0].name+"("+q[0].code+")</a>");$("#stock-view .wk-hot-table tbody").html(common.buildHotmapTable(q,"stock"));$("#stock-view .right .wk-treemap-table tbody").html(common.buildStockTable(d));common.buildHotmap("wk-stock-view-treemap",d,"stock")}if(e.result.code_info.shs_.length>0){var s=e.result.code_info.shs_;var f=e.result.code_info.sus_;$("#hot-search-stock").html("<a class='"+Utility.getPriceColor(s[0].price)+"' href='stocks.php?stock="+s[0].code+"' target='_blank'>"+s[0].name+"("+s[0].code+")</a>");$("#stock-search .wk-hot-table tbody").html(common.buildHotmapTable(s,"stock"));$("#stock-search .right .wk-treemap-table tbody").html(common.buildStockTable(f));common.buildHotmap("wk-stock-search-treemap",f,"stock")}if(e.result.code_info.shf_.length>0){var y=e.result.code_info.shf_;var l=e.result.code_info.suf_;$("#hot-follow-stock").html("<a class='"+Utility.getPriceColor(y[0].price)+"' href='stocks.php?stock="+y[0].code+"' target='_blank'>"+y[0].name+"("+y[0].code+")</a>");$("#stock-follow .wk-hot-table tbody").html(common.buildHotmapTable(y,"stock"));$("#stock-follow .right .wk-treemap-table tbody").html(common.buildStockTable(l));common.buildHotmap("wk-stock-follow-treemap",l,"stock")}if(e.result.code_info.hhv_.length>0){var o=e.result.code_info.hhv_;var x=e.result.code_info.huv_;$("#industry-view .wk-hot-table tbody").html(common.buildHotmapTable(o,"industry"));$("#industry-view .right .wk-treemap-table tbody").html(common.buildOtherTable(x,"industry"));common.buildHotmap("wk-industry-view-treemap",x,"industry")}if(e.result.code_info.hhs_.length>0){var p=e.result.code_info.hhs_;var b=e.result.code_info.hus_;$("#industry-search .wk-hot-table tbody").html(common.buildHotmapTable(p,"industry"));$("#industry-search .right .wk-treemap-table tbody").html(common.buildOtherTable(b,"industry"));common.buildHotmap("wk-industry-search-treemap",b,"industry")}if(e.result.code_info.hhf_.length>0){var v=e.result.code_info.hhf_;var i=e.result.code_info.huf_;$("#industry-follow .wk-hot-table tbody").html(common.buildHotmapTable(v,"industry"));$("#industry-follow .right .wk-treemap-table tbody").html(common.buildOtherTable(i,"industry"));common.buildHotmap("wk-industry-follow-treemap",i,"industry")}if(e.result.code_info.ghv_.length>0){var a=e.result.code_info.ghv_;var m=e.result.code_info.guv_;$("#concept-view .wk-hot-table tbody").html(common.buildHotmapTable(a,"concept"));$("#concept-view .right .wk-treemap-table tbody").html(common.buildOtherTable(m,"concept"));common.buildHotmap("wk-concept-view-treemap",m,"concept")}if(e.result.code_info.ghs_.length>0){var c=e.result.code_info.ghs_;var n=e.result.code_info.gus_;$("#concept-search .wk-hot-table tbody").html(common.buildHotmapTable(c,"concept"));$("#concept-search .right .wk-treemap-table tbody").html(common.buildOtherTable(n,"concept"));common.buildHotmap("wk-concept-search-treemap",n,"concept")}if(e.result.code_info.ghf_.length>0){var j=e.result.code_info.ghf_;var t=e.result.code_info.guf_;$("#concept-follow .wk-hot-table tbody").html(common.buildHotmapTable(j,"concept"));$("#concept-follow .right .wk-treemap-table tbody").html(common.buildOtherTable(t,"concept"));common.buildHotmap("wk-concept-follow-treemap",t,"concept")}if(e.result.code_info.ehv_.length>0){var u=e.result.code_info.ehv_;var h=e.result.code_info.euv_;$("#event-view .wk-hot-table tbody").html(common.buildHotmapTable(u,"event"));$("#event-view .right .wk-treemap-table tbody").html(common.buildOtherTable(h,"event"));common.buildHotmap("wk-event-view-treemap",h,"event")}if(e.result.code_info.ehs_.length>0){var w=e.result.code_info.ehs_;var k=e.result.code_info.eus_;$("#event-search .wk-hot-table tbody").html(common.buildHotmapTable(w,"event"));$("#event-search .right .wk-treemap-table tbody").html(common.buildOtherTable(k,"event"));common.buildHotmap("wk-event-search-treemap",k,"event")}if(e.result.code_info.ehf_.length>0){var g=e.result.code_info.ehf_;var r=e.result.code_info.euf_;$("#event-follow .wk-hot-table tbody").html(common.buildHotmapTable(g,"event"));$("#event-follow .right .wk-treemap-table tbody").html(common.buildOtherTable(r,"event"));common.buildHotmap("wk-event-follow-treemap",r,"event")}}function initTimeLine(){common.getRealTimeHot(null,null,function(a){if(a.status==1){var b=[];if(a.visit){for(var j in a.visit){viewData.push(a.visit[j])}viewData=JSON.parse("["+viewData.join(",")+"]");var i=Math.max.apply(Math,viewData);var c=viewData.indexOf(Math.max.apply(Math,viewData));b.push("<tr><td>查看</td><td>"+i+"</td><td>"+Utility.calTime(c)+"</td></tr>")}if(a.search){for(var l in a.search){searchData.push(a.search[l])}searchData=JSON.parse("["+searchData.join(",")+"]");var k=Math.max.apply(Math,searchData);var d=searchData.indexOf(Math.max.apply(Math,searchData));b.push("<tr><td>搜索</td><td>"+k+"</td><td>"+Utility.calTime(d)+"</td></tr>")}if(a.follow){for(var h in a.follow){followData.push(a.follow[h])}followData=JSON.parse("["+followData.join(",")+"]");var g=Math.max.apply(Math,followData);var e=followData.indexOf(Math.max.apply(Math,followData));b.push("<tr><td>关注</td><td>"+g+"</td><td>"+Utility.calTime(e)+"</td></tr>")}$(".todayhot").html(b.join(""));common.getLineChart("left-chart",xdata,viewData,searchData,followData)}})}$(function(){initTreeMapChart();initTimeLine()});