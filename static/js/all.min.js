"use strict";$(function(){var a="http://"+window.location.host+"/";$(".wk-head-search").typeahead({minLength:2,maxItem:20,order:"asc",hint:true,group:true,maxItemPerGroup:5,backdrop:false,dynamic:true,filter:false,emptyTemplate:'未找到 "{{query}}" 的相关信息',source:{"股票":{url:[a+"ajax/ajax_search.php?message={{query}},","stock"]},"行业":{url:[a+"ajax/ajax_search.php?message={{query}},","hy"]},"概念":{url:[a+"ajax/ajax_search.php?message={{query}},","gn"]},"热点事件":{url:[a+"ajax/ajax_search.php?message={{query}},","event"]}},callback:{onClickAfter:function(d,b,c){if(c.display!==""){switch(c.group){case"股票":window.open(a+"stocks.php?stock="+c.display.substring(c.display.indexOf("(")+1,c.display.indexOf(")")),"_blank");break;case"行业":window.open(a+"industry.php?name="+c.display,"_blank");break;case"概念":window.open(a+"concept.php?name="+c.display,"_blank");break;case"热点事件":window.open(a+"event.php?name="+c.display,"_blank");break;default:window.open(a+"error.php","_blank");break}}}}});Number.prototype.toWanNum=function(){var b=this;return(b/10000).toFixed(2)+"万"};Number.prototype.toFormatNum=function(){var b=this;return b&&(b.toString().indexOf(".")!=-1?b.toString().replace(/(\d)(?=(\d{3})+\.)/g,function(d,c){return c+","}):b.toString().replace(/(\d)(?=(\d{3})+\b)/g,function(d,c){return c+","}))};$("i[data-toggle='popover']").popover({container:"body",trigger:"hover"});$('.wk-hotmap a[data-toggle="tab"]').on("shown.bs.tab",function(){initTreeMapChart()});$(".wk-line-toggle a").click(function(){$(this).addClass("line-active").siblings().removeClass("line-active");var d=$(this).parent().attr("data-query-type");var c=$(this).parent().attr("data-query-key");var e=$(this).attr("data-key");var b={query_type:d,key_name:c,time_type:e};if(e=="day"){common.getLineChart("left-chart",xdata,viewData,searchData,followData)}else{common.getHotRecord(b,function(){var f=echarts.init(document.getElementById("left-chart"));f.showLoading({text:"加载中..."})},function(h){var j=[];var l=[];var m=[];var i=[];if(h.status==1){for(var o in h.visit){for(var n in h.visit[o]){i.push(n);j.push(h.visit[o][n])}}for(var q in h.search){for(var p in h.search[q]){l.push(h.search[q][p])}}for(var k in h.follow){for(var g in h.follow[k]){m.push(h.follow[k][g])}}}common.getLineChart("left-chart",i,j,l,m)})}});$(".treemap-toggle span").click(function(){$(this).addClass("treemap-active").siblings().removeClass("treemap-active");var b=$(this).parent().parent().parent();if($(this).html()=="热力图"){b.find(".toggle-treemap").show();b.find(".toggle-treemap-table-up").hide();b.find(".toggle-treemap-table-down").hide();initTreeMapChart()}else{if($(this).html()=="涨幅"){b.find(".toggle-treemap").hide();b.find(".toggle-treemap-table-up").show();b.find(".toggle-treemap-table-down").hide()}else{if($(this).html()=="跌幅"){b.find(".toggle-treemap").hide();b.find(".toggle-treemap-table-up").hide();b.find(".toggle-treemap-table-down").show()}}}});$(".wk-rate-select label").click(function(){$(this).addClass("active").siblings().removeClass("active");var f=$(this).parent().attr("data-query-name");var d=$(this).parent().attr("data-query-type");var b=$(this).attr("data-toggle");var e=echarts.init(document.getElementById("wk-rate-line-pic"));var c={query_type:d,query_key:f,query_date:b};if(d=="stock"){if(_stockName){f=_stockName}}switch(b){case"today":common.getRateLine(c,function(){e.showLoading({text:"加载中..."})},function(g){common.buildRateLine(f,b,g);e.hideLoading()});break;case"week":common.getRateLine(c,function(){e.showLoading({text:"加载中..."})},function(g){common.buildRateLine(f,b,g);e.hideLoading()});break;case"month":common.getRateLine(c,function(){e.showLoading({text:"加载中..."})},function(g){common.buildRateLine(f,b,g);e.hideLoading()});break;case"threemonth":common.getRateLine(c,function(){e.showLoading({text:"加载中..."})},function(g){common.buildRateLine(f,b,g);e.hideLoading()});break;default:break}})});