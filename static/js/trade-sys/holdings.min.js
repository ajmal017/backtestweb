"use strict";$(function(){function l(){trade.getStockPoint(function(){$(".index-items").html("<div class=\"wk-user-no\"><i class='fa fa-refresh fa-spin'></i>&nbsp;正在加载...</div>")},function(m){if(m&&m.status==1){var n=template("tpl",m);$(".index-items").html(n)}})}$(".myAccount").click(function(){$(".myAccount-1").show();$(this).siblings().find(".myAccount-1").hide()});function j(r,q,o){var p=echarts.init(document.getElementById("profit"));var m=echarts.init(document.getElementById("loss"));var q={total:80000,month:12,per:6936.16,unit:8};var n={backgroundColor:"#fff",color:["#D14A4A","#eee"],series:[{type:"pie",radius:["50%","70%"],symbolSize:11,hoverAnimation:false,labelLine:{normal:{show:false}},data:[{value:20,name:""},{value:80,name:""}]}]};p.setOption(n);m.setOption(n)}function c(){trade.getAccountInfo(function(){$(".fund-data").html("<div class=\"row-no\"><i class='fa fa-refresh fa-spin'></i>&nbsp;正在加载中...</div>")},function(n){if(n.status==1){var m=[];var o=n.result;m.push('<div class="col-md-4 col-xs-6 fund-item">总资产: '+o.total_assets+"</div>");m.push('<div class="col-md-4 col-xs-6 fund-item">当日收益率：'+(o.yields_of_day*100).toFixed(2)+"%</div>");m.push('<div class="col-md-4 col-xs-6 fund-item">总收益率：'+(o.total_yields*100).toFixed(2)+"%</div>");m.push('<div class="col-md-4 col-xs-6 fund-item">可用资金：'+o.usable_assets+"</div>");m.push('<div class="col-md-4 col-xs-6 fund-item">当日盈亏：'+o.profit_or_loss+"</div>");m.push('<div class="col-md-4 col-xs-6 fund-item">股票市值：'+o.stock_value+"</div>");$(".fund-data .row").html(m.join(""))}})}var k;function g(){trade.getUserRelatedOp({opcode:104},null,function(o){if(o.status==0){var m=[];var p=o.group_list;for(var n=0;n<p.length;n++){if(n===0){k=p[n].id;m.push(' <li role="presentation" class="active" data-gid="'+p[n].id+'"><a href="#index1-1" role="tab" data-toggle="tab">'+p[n].name+"</a></li>")}else{m.push(' <li role="presentation" data-gid="'+p[n].id+'"><a href="#index1-1" role="tab" data-toggle="tab">'+p[n].name+"</a></li>")}}$(".myGroup ul").html(m.join(""));h(k)}})}function h(m){trade.getUserRelatedOp({opcode:105,gid:m},null,function(p){var n=[];var q=p.stock_list;for(var o=0;o<q.length;o++){n.push("<tr>");n.push("<td>"+(o+1)+"</td>");n.push('<td><input type="checkbox" class="checkbox"><a href="http://stock.iwookong.com/ajax/login/nologin.php?stock='+q[o].code+"&uid="+uid+'&token=token" target="_blank">'+q[o].name+"</a></td>");n.push('<td><a href="http://stock.iwookong.com/ajax/login/nologin.php?stock='+q[o].code+"&uid="+uid+'&token=token" target="_blank">'+q[o].code+"</a></td>");n.push("<td>"+q[o].visit_heat+"</td>");n.push("<td>"+q[o].price+"</td>");n.push("<td>"+q[o].change+"</td>");n.push("<td>"+q[o].volume+"</td>");n.push("<td>"+q[o].industry+"</td>");n.push('<td class="call_back" data-groupStockList-id="'+q[o].id+'"><a href=""><img src="/static/imgs/trade/op_buy.png">&nbsp<img src="/static/imgs/trade/op_sale.png"></a></td>');n.push("</tr>")}$(".groupStockList table tbody").html(n.join(""))})}$("body").on("click",".myGroup ul li",function(){var m=$(this).attr("data-gid");h(m)});function d(){trade.getUserRelatedOp({opcode:106,gid:1},null,function(o){console.log(o);if(o.status==0){var m=[];var p=o.stock_list;if(p.length>0){for(var n=0;n<p.length;n++){m.push("<tr>");m.push("<td>"+(n+1)+"</td>");m.push("<td>"+p[n].code+"</td>");m.push("<td>"+p[n].holding+"</td>");m.push("<td>"+p[n].available+"</td>");m.push("<td>"+p[n].cost+"</td>");m.push("<td>"+p[n].price+"</td>");m.push("<td>"+p[n].market_value+"</td>");m.push("<td>"+p[n].profit+"</td>");m.push("<td>"+p[n].profit_ratio+"</td>");m.push("<td>"+p[n].position+"</td>");m.push('<td class="call_back" data-holding-id="'+p[n].id+'"><img src="/static/imgs/trade/op_buy.png">&nbsp<img src="/static/imgs/trade/op_sale.png"></td>');m.push("</tr>")}}else{m.push("<tr><td colspan='11' style='padding: 50px 0 40px 0;'><i class='fa fa-exclamation-circle'></i>&nbsp;当前没有任何记录...</td></tr>")}$(".holdingStock table tbody").html(m.join(""))}})}function e(){trade.getUserRelatedOp({opcode:107,gid:1},null,function(n){if(n.status==0){var p=[];var o=n.order_list;if(o.length>0){for(var m=0;m<o.length;m++){p.push("<tr>");p.push("<td>"+(m+1)+"</td>");p.push('<td><a href="http://stock.iwookong.com/ajax/login/nologin.php?stock='+o[m].code+"&uid="+uid+'&token=token" target="_blank">'+o[m].name+"("+o[m].code+")</a></td>");if(o[m].order_operation){p.push("<td>卖出</td>")}else{p.push("<td>买入</td>")}p.push("<td>"+o[m].order_price+"</td>");p.push("<td>"+o[m].order_nums+"</td>");p.push("<td>"+Utility.unixToDate4(o[m].order_time)+"</td>");if(o[m].status){p.push("<td>已成交</td>")}else{p.push("<td>未成交</td>")}p.push('<td class="call-back" data-order-id="'+o[m].id+'">撤销</td>');p.push("</tr>")}$(".orderStock table tbody").html(p.join(""))}else{p.push("<tr><td colspan='8' style='padding: 50px 0 40px 0;'><i class='fa fa-exclamation-circle'></i>&nbsp;当前没有任何记录...</td></tr>")}}})}function f(){trade.getUserRelatedOp({opcode:108,gid:1},null,function(o){if(o.status==0){var m=[];var p=o.order_list;if(p.length>0){for(var n=0;n<p.length;n++){m.push("<tr>");m.push("<td>"+(n+1)+"</td>");m.push("<td>"+p[n].code+"</td>");if(p[n].order_operation){m.push("<td>卖出</td>")}else{m.push("<td>买入</td>")}m.push("<td>"+p[n].order_price+"</td>");m.push("<td>"+p[n].order_nums+"</td>");m.push("<td>"+p[n].amount+"</td>");m.push("<td>"+Utility.unixToDate4(p[n].order_time)+"</td>");m.push("</tr>")}}$(".finishedOrder table tbody").html(m.join(""))}})}function i(){trade.getUserRelatedOp({opcode:109,gid:1},null,function(o){if(o.status==0){var n=[];var p=o.order_list;for(var m=0;m<p.length;m++){n.push("<tr>");n.push("<td>"+(m+1)+"</td>");n.push("<td>"+p[m].code+"</td>");if(p[m].order_operation){n.push("<td>卖出</td>")}else{n.push("<td>买入</td>")}n.push("<td>"+p[m].order_price+"</td>");n.push("<td>"+p[m].order_nums+"</td>");n.push("<td>"+p[m].amount+"</td>");n.push("<td>"+Utility.unixToDate4(p[m].order_time)+"</td>");n.push("</tr>")}$(".HistoryOrder table tbody").html(n.join(""))}})}function b(){trade.getUserRelatedOp({opcode:110,end_time:"2017-01-12",start_time:"2017-01-20"},null,function(n){if(n.status==0){var p=[];var o=n.statement_list;console.log(o);for(var m=0;m<o.length;m++){p.push("<tr>");p.push("<td>"+Utility.unixToDate4(o[m].amount)+"</td>");p.push("<td>"+o[m].code+"</td>");if(o[m].order_operation){p.push("<td>卖出</td>")}else{p.push("<td>买入</td>")}p.push("<td>"+o[m].order_price+"</td>");p.push("<td>"+o[m].order_nums+"</td>");p.push("<td>"+o[m].commission+"</td>");p.push("<td>"+o[m].order_operation+"</td>");p.push("<td>"+o[m].stamp_duty+"</td>");p.push("<td>"+o[m].transfer_fee+"</td>");p.push("<td>"+o[m].available_capital+"</td>");p.push("</tr>")}$(".statement table tbody").html(p.join(""))}})}var a={getGroupStock:function(m){trade.showstock({ori_name:m},function(){$(".wk-sub-refresh").addClass("fa-spin");$(".wk-user-mychoose-table table>tbody").html("<tr><td colspan='11'><div class=\"wk-user-no\"><i class='fa fa-refresh fa-spin'></i>&nbsp;正在加载...</div></td></tr>")},function(){$(".wk-sub-refresh").removeClass("fa-spin");var o=$(".wk-user-mynews").attr("data-query-type");var n=$(".wk-user-mynews").attr("data-info-type");if(_all_stock_code.join("|").length>0){if(n==0){a.getNews({query_type:o,start_time:0,info_type:n,stock_list:_all_stock_code.join("|")+"|"})}if(n==1){a.getFastNews({query_type:o,start_time:0,info_type:n,stock_list:_all_stock_code.join("|")+"|"})}if(n==2){a.getMedia({query_type:o,start_time:0,info_type:n,stock_list:_all_stock_code.join("|")+"|"})}}else{if(n==0){a.getNews({query_type:o,start_time:0,info_type:n,stock_list:"00000x|"})}if(n==1){a.getFastNews({query_type:o,start_time:0,info_type:n,stock_list:"00000x|"})}if(n==2){a.getMedia({query_type:o,start_time:0,info_type:n,stock_list:"00000x|"})}}a.getPlatform()})},getPlatform:function(){trade.getPlatform(function(){$(".wk-user-news-loading").show()},function(m){if(m&&m.status==1){var q=m.result[0].news_info_plat;var r=m.result[2].media_info_plat;if(q&&q.length>0){var o=[];for(var n=0;n<q.length;n++){o.push('<div class="con-item">');if(q[n].is_choosed==1){o.push("<label><span class='active'>"+q[n].platform_name+'</span>&nbsp;<i class="fa fa-times-circle" data-platform=\''+q[n].platform_id+"'></i></label>")}else{o.push("<label><span>"+q[n].platform_name+'</span>&nbsp;<i class="fa fa-plus"  data-platform=\''+q[n].platform_id+"'></i></label>")}o.push("</div>")}$(".wk-user-news-list .wk-user-news-ctrl-con").html(o.join(""))}if(r&&r.length>0){var p=[];for(var n=0;n<r.length;n++){p.push('<div class="con-item">');if(r[n].is_choosed==1){p.push("<label><span class='active'>"+r[n].platform_name+'</span>&nbsp;<i class="fa fa-times-circle"  data-platform=\''+r[n].platform_id+"'></i></label>")}else{p.push("<label><span>"+r[n].platform_name+'</span>&nbsp;<i class="fa fa-plus"  data-platform=\''+r[n].platform_id+"'></i></label>")}p.push("</div>")}$(".wk-user-vpoint-ctrl .wk-user-news-ctrl-con").html(p.join(""))}$(".wk-user-news-ctrl-con div").hover(function(){$(this).find("i").show()},function(){$(this).find("i").hide()});$(".con-item i").each(function(){$(this).unbind("click").bind("click",function(w){var v=$(this);var u=v.attr("data-platform");if(v.hasClass("fa-times-circle")){trade.delUserPlatform({plat_id:u},null,function(y){if(y.status==1){v.removeClass("fa-times-circle").addClass("fa-plus").siblings().removeClass("active")}})}else{trade.addUserPlatform({plat_id:u},null,function(y){if(y.status==1){v.removeClass("fa-plus").addClass("fa-times-circle").siblings().addClass("active")}})}var t=$(".wk-user-mynews").attr("data-query-type");var s=$(".wk-user-mynews").attr("data-info-type");var x=$(".wk-user-mynews").attr("data-stock");if(s==0){a.getNews({query_type:t,start_time:0,info_type:s,stock_list:x})}if(s==2){a.getMedia({query_type:t,start_time:0,info_type:s,stock_list:x})}w.stopPropagation()})});$(".wk-user-mynews .btn-group i").each(function(){$(this).unbind("click").bind("click",function(){var t=$(this).parent().parent();var s=t.attr("data-target");var u=$(".wk-user-mynews").attr("data-stock");if(s=="wk-user-news-list"){if(t.hasClass("active")){if($(this).attr("data-expand")!="false"){$(this).addClass("fa-chevron-down").removeClass("fa-chevron-up").attr("data-expand",false);$(".wk-user-news-ctrl").hide()}else{$(this).addClass("fa-chevron-up").removeClass("fa-chevron-down").attr("data-expand",true);$(".wk-user-news-ctrl").show()}$("#"+s+" .wk-user-news-ctrl-head div").click(function(){$(this).addClass("active").siblings().removeClass("active");if($(this).hasClass("user-default")){$(".wk-user-mynews").attr("data-query-type",1).attr("data-info-type","0");a.getNews({query_type:1,start_time:0,info_type:0,stock_list:u})}if($(this).hasClass("user-define")){$(this).find("i").unbind("click").bind("click",function(){if($(this).attr("data-expand")=="false"){$(this).addClass("fa-caret-up").removeClass("fa-caret-down");$("#"+s+" .wk-user-news-ctrl-con").show();$(this).attr("data-expand",true)}else{$(this).addClass("fa-caret-down").removeClass("fa-caret-up");$("#"+s+" .wk-user-news-ctrl-con").hide();$(this).attr("data-expand",false)}});$(".wk-user-mynews").attr("data-query-type",2).attr("data-info-type","0");a.getNews({query_type:2,start_time:0,info_type:0,stock_list:u})}})}return}if(s=="wk-user-vpoint-list"){if(t.hasClass("active")){if($(this).attr("data-expand")=="false"){$(this).addClass("fa-chevron-up").removeClass("fa-chevron-down").attr("data-expand",true);$(".wk-user-vpoint-ctrl").show()}else{$(this).addClass("fa-chevron-down").removeClass("fa-chevron-up").attr("data-expand",false);$(".wk-user-vpoint-ctrl").hide()}$("#"+s+" .wk-user-news-ctrl-head div").click(function(){$(this).addClass("active").siblings().removeClass("active");var v=$(".wk-user-mynews").attr("data-stock");if($(this).hasClass("user-default")){$(".wk-user-mynews").attr("data-query-type",1).attr("data-info-type","2");a.getMedia({query_type:1,start_time:0,info_type:2,stock_list:v})}if($(this).hasClass("user-define")){$(this).find("i").unbind("click").bind("click",function(){if($(this).attr("data-expand")=="false"){$(this).addClass("fa-caret-up").removeClass("fa-caret-down");$("#"+s+" .wk-user-news-ctrl-con").show();$(this).attr("data-expand",true)}else{$(this).addClass("fa-caret-down").removeClass("fa-caret-up");$("#"+s+" .wk-user-news-ctrl-con").hide();$(this).attr("data-expand",false)}});$(".wk-user-mynews").attr("data-query-type",2).attr("data-info-type","2");a.getMedia({query_type:2,start_time:0,info_type:2,stock_list:v})}})}}})})}})},getNews:function(m){trade.getRelatedInfo(m,function(){$(".wk-user-news-loading").show();$("#wk-user-news-list").find(".wk-con").empty()},function(n){$(".wk-user-news-loading").hide();var o="";if(n){o=a.buildNews(n.result)}else{o='<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关快讯</span></div>'}$("#wk-user-news-list").find(".wk-con").html(o)})},getMedia:function(m){trade.getRelatedInfo(m,function(){$("#wk-user-vpoint-list").find(".wk-con").empty();$(".wk-user-news-loading").show()},function(n){$(".wk-user-news-loading").hide();var o="";if(n){o=a.buildMedia(n.result)}else{o='<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关达人观点</span></div>'}$("#wk-user-vpoint-list").find(".wk-con").html(o)})},getFastNews:function(m){trade.getRelatedInfo(m,function(){$("#wk-user-fastnews-list").find(".wk-con").empty();$(".wk-user-news-loading").show()},function(n){$(".wk-user-news-loading").hide();var o="";if(n){o=a.buildFastNews(n.result)}else{o='<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关快讯</span></div>'}$("#wk-user-fastnews-list").find(".wk-con").html(o)})},getNotice:function(m){trade.getRelatedInfo(m,function(){$(".wk-user-news-loading").show();$("#wk-user-notice-list").find(".wk-con").empty()},function(n){$(".wk-user-news-loading").hide();var o="";if(n){o=a.buildNotice(n.result)}else{o='<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关公告</span></div>'}$("#wk-user-notice-list").find(".wk-con").html(o)})},getReport:function(m){trade.getRelatedInfo(m,function(){$(".wk-user-news-loading").show();$("#wk-user-report-list").find(".wk-con").empty()},function(n){$(".wk-user-news-loading").hide();var o="";if(n){o=a.buildReport(n.result)}else{o='<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关公告</span></div>'}$("#wk-user-report-list").find(".wk-con").html(o)})},buildNews:function(n){var p=[];if(n.length>0){for(var o=0;o<n.length;o++){p.push('<div class="wk-news-list" id="news_'+n[o].info_id+'" data-news-timestamp="'+n[o].timestamp+'">');p.push('<div class="news-rel-stock">');if(n[o].related_stock.length>0){for(var m=0;m<n[o].related_stock.length;m++){var r=n[o].related_stock[m].stock_name;var s=n[o].related_stock[m].stock_code;var q=n[o].related_stock[m].price_up_down;if(r!=""&&s!=""){p.push("<a class='"+Utility.getPriceColor(q)+"' href='../stocks.php?stock="+s+"' target='_blank'>●&nbsp;"+r+"("+s+")</a>")}}}p.push("</div>");p.push('<div class="wk-news-list-head">');p.push('<p class="wk-news-list-title"><a href="../detail.php?infoid='+n[o].info_id+'" target="_blank">');p.push(n[o].titile);p.push("</a></p>"+Utility.getgetEmotion(n[o].sentiment)+'</div><div class="wk-news-list-con"><p>');if(n[o].summary!=""){p.push("<strong>【机器人摘要】</strong>");p.push(n[o].summary);p.push('<a href="../detail.php?infoid='+n[o].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}p.push("</p><span>来源："+n[o].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(n[o].timestamp)+"</span></div><hr></div>")}}else{p.push('<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关新闻资讯</span></div>')}return p.join("")},buildMedia:function(o){var m=[];if(o.length>0){for(var p=0;p<o.length;p++){m.push('<div class="wk-news-list" id="media_'+o[p].info_id+'" data-news-timestamp="'+o[p].timestamp+'">');m.push('<div class="news-rel-stock">');if(o[p].related_stock.length>0){for(var n=0;n<o[p].related_stock.length;n++){var r=o[p].related_stock[n].stock_name;var s=o[p].related_stock[n].stock_code;var q=o[p].related_stock[n].price_up_down;if(r!=""&&s!=""){m.push("<a class='"+Utility.getPriceColor(q)+"' href='../stocks.php?stock="+s+"' target='_blank'>●&nbsp;"+r+"("+s+")</a>")}}}m.push("</div>");m.push('<div class="wk-news-list-head">');m.push('<p class="wk-news-list-title"><a href="../detail.php?infoid='+o[p].info_id+'" target="_blank">');m.push(o[p].titile);m.push("</a></p>"+Utility.getgetEmotion(o[p].sentiment)+'</div><div class="wk-news-list-con"><p>');if(o[p].summary!=""){m.push("<strong>【机器人摘要】</strong>");m.push(o[p].summary);m.push('<a href="../detail.php?infoid='+o[p].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}m.push("</p><span>来源："+o[p].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(o[p].timestamp)+"</span></div><hr></div>")}}else{m.push('<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关达人观点</span></div>')}return m.join("")},buildFastNews:function(o){var q=[];if(o.length>0){for(var p in o){for(var n in o[p]){q.push();q.push('<div class="wk-user-fastnews">');q.push('<span class="wk-user-fastnews-dot">●</span>');q.push('<p class="wk-user-fastnews-todate">'+n+"</p>");q.push("<ul>");for(var m=0;m<o[p][n].length;m++){q.push("<li id='"+o[p][n][m].info_id+"' data-fastnews-timestamp='"+o[p][n][m].timestamp+"'>");q.push("<label>"+Utility.unixToTime(o[p][n][m].timestamp)+"</label>");q.push("<p>"+o[p][n][m].summary+"</p>");q.push("</li>")}q.push("</ul></div>")}}}else{q.push('<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关快讯</span></div>');$(".wk-user-fastnews-list").css("border","none")}return q.join("")},buildNotice:function(n){var r=[];if(n.length>0){for(var o=0;o<n.length;o++){r.push('<div class="wk-news-list" id="notice_'+n[o].info_id+'" data-news-timestamp="'+n[o].timestamp+'">');r.push('<div class="news-rel-stock">');if(n[o].related_stock.length>0){for(var m=0;m<n[o].related_stock.length;m++){var q=n[o].related_stock[m].stock_name;var s=n[o].related_stock[m].stock_code;var p=n[o].related_stock[m].price_up_down;if(q!=""&&s!=""){r.push("<a class='"+Utility.getPriceColor(p)+"' href='../stocks.php?stock="+s+"' target='_blank'>●&nbsp;"+q+"("+s+")</a>")}}}r.push("</div>");r.push('<div class="wk-news-list-head">');r.push('<p class="wk-news-list-title"><a href="../detail.php?infoid='+n[o].info_id+'" target="_blank">');r.push(n[o].titile);r.push("</a></p>"+Utility.getgetEmotion(n[o].sentiment)+'</div><div class="wk-news-list-con"><p>');if(n[o].summary!=""){r.push("<strong>【机器人摘要】</strong>");r.push(n[o].summary);r.push('<a href="../detail.php?infoid='+n[o].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}r.push("</p><span>来源："+n[o].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(n[o].timestamp)+"</span></div><hr></div>")}}else{r.push('<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关新闻公告</span></div>')}return r.join("")},buildReport:function(o){var m=[];if(o.length>0){for(var p=0;p<o.length;p++){m.push('<div class="wk-news-list" id="report_'+o[p].info_id+'" data-news-timestamp="'+o[p].timestamp+'">');m.push('<div class="news-rel-stock">');if(o[p].related_stock.length>0){for(var n=0;n<o[p].related_stock.length;n++){var r=o[p].related_stock[n].stock_name;var s=o[p].related_stock[n].stock_code;var q=o[p].related_stock[n].price_up_down;if(r!=""&&s!=""){m.push("<a class='"+Utility.getPriceColor(q)+"' href='../stocks.php?stock="+s+"' target='_blank'>●&nbsp;"+r+"("+s+")</a>")}}}m.push("</div>");m.push('<div class="wk-news-list-head">');m.push('<p class="wk-news-list-title"><a href="../detail.php?infoid='+o[p].info_id+'" target="_blank">');m.push(o[p].titile);m.push("</a></p>"+Utility.getgetEmotion(o[p].sentiment)+'</div><div class="wk-news-list-con"><p>');if(o[p].summary!=""){m.push("<strong>【机器人摘要】</strong>");m.push(o[p].summary);m.push("<a class='"+Utility.getPriceColor(q)+"' href=\"../detail.php?infoid="+o[p].info_id+'" target="_blank"><i class="fa fa-link"></i>详情链接</a>')}m.push("</p><span>来源："+o[p].from+"&nbsp;&nbsp;&nbsp;&nbsp;"+Utility.unixToDate(o[p].timestamp)+"</span></div><hr></div>")}}else{m.push('<div class="wk-user-no"><img src="../static/imgs/i/nonews.png"><span>暂无相关新闻研报</span></div>')}return m.join("")}};$(".wk-user-mynews .btn-group span:first-child").bind("click",function(){var n=$(this).parent().parent();var o=$(".wk-user-mynews").attr("data-stock");var m=n.attr("data-target");n.addClass("active").siblings().removeClass("active");$("#"+m).show().siblings().hide();if(m=="wk-user-news-list"){$("#"+m).find(".wk-con").html("");a.getNews({query_type:1,start_time:0,info_type:0,stock_list:o});$(".wk-user-mynews").attr("data-info-type",0);$(".wk-user-mynews").attr("data-query-type",1)}if(m=="wk-user-fastnews-list"){$("#"+m).find(".wk-con").html("");a.getFastNews({query_type:1,start_time:0,info_type:1,stock_list:o});$(".wk-user-mynews").attr("data-info-type",1);$(".wk-user-mynews").attr("data-query-type",1)}if(m=="wk-user-vpoint-list"){$("#"+m).find(".wk-con").html("");a.getMedia({query_type:1,start_time:0,info_type:2,stock_list:o});$(".wk-user-mynews").attr("data-info-type",2);$(".wk-user-mynews").attr("data-query-type",1)}if(m=="wk-user-notice-list"){$("#"+m).find(".wk-con").html("");a.getNotice({query_type:1,start_time:0,info_type:4,stock_list:o});$(".wk-user-mynews").attr("data-info-type",4);$(".wk-user-mynews").attr("data-query-type",1)}if(m=="wk-user-report-list"){$("#"+m).find(".wk-con").html("");a.getReport({query_type:1,start_time:0,info_type:3,stock_list:o});$(".wk-user-mynews").attr("data-info-type",3);$(".wk-user-mynews").attr("data-query-type",1)}});$(window).scroll(function(){var o=$(this).scrollTop();var u=$(document).height();var m=$(this).height();if(u-o-m==0){var q=$(".wk-user-mynews").attr("data-stock");var p=$(".wk-user-mynews").attr("data-query-type");var r=$(".wk-user-mynews").attr("data-info-type");if(r=="0"){var s=$("#wk-user-news-list .wk-con").find(".wk-news-list:last-child");var t=s.attr("id");var n=s.attr("data-news-timestamp");trade.getRelatedInfo({query_type:p,info_type:r,start_time:n,stock_list:q,start_id:t?t.replace("news_",""):""},function(){$(".wk-user-news-loading").show()},function(v){$(".wk-user-news-loading").hide();if(v.result.length>0){var w=a.buildNews(v.result);$("#wk-user-news-list .wk-con").append(w)}});return}if(r=="1"){var s=$("#wk-user-fastnews-list .wk-user-fastnews:last-child").find("ul li:last-child");var t=s.attr("id");var n=s.attr("data-fastnews-timestamp");trade.getRelatedInfo({query_type:p,info_type:r,start_time:n,stock_list:q,start_id:t?t.replace("fastnews_",""):""},function(){$(".wk-user-news-loading").show()},function(v){$(".wk-user-news-loading").hide();if(v.result.length>0){var w=a.buildFastNews(v.result);$("#wk-user-fastnews-list .wk-con").append(w)}});return}if(r=="2"){var s=$("#wk-user-vpoint-list .wk-con").find(".wk-news-list:last-child");var t=s.attr("id");var n=s.attr("data-news-timestamp");trade.getRelatedInfo({query_type:p,info_type:r,start_time:n,stock_list:q,start_id:t?t.replace("media_",""):""},function(){$(".wk-user-news-loading").show()},function(v){$(".wk-user-news-loading").hide();if(v.result.length>0){var w=a.buildMedia(v.result);$("#wk-user-vpoint-list .wk-con").append(w)}})}if(r=="3"){var s=$("#wk-user-report-list .wk-con").find(".wk-news-list:last-child");var t=s.attr("id");var n=s.attr("data-news-timestamp");trade.getRelatedInfo({query_type:p,info_type:r,start_time:n,stock_list:q,start_id:t?t.replace("report_",""):""},function(){$(".wk-user-news-loading").show()},function(v){$(".wk-user-news-loading").hide();if(v.result.length>0){var w=a.buildReport(v.result);$("#wk-user-report-list .wk-con").append(w)}})}if(r=="4"){var s=$("#wk-user-notice-list .wk-con").find(".wk-news-list:last-child");var t=s.attr("id");var n=s.attr("data-news-timestamp");trade.getRelatedInfo({query_type:p,info_type:r,start_time:n,stock_list:q,start_id:t?t.replace("notice_",""):""},function(){$(".wk-user-news-loading").show()},function(v){$(".wk-user-news-loading").hide();if(v.result.length>0){var w=a.buildNotice(v.result);$("#wk-user-notice-list .wk-con").append(w)}})}}});l();j();c();g();d();e();f();i();b()});